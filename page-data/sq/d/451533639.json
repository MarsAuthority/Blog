{"data":{"allMdx":{"nodes":[{"fields":{"slug":"/placeholder/","title":"This Is a Placeholder File for Mdx"},"frontmatter":{"draft":true},"rawBody":"---\ntitle: This Is a Placeholder File for Mdx\ndraft: true\ntags:\n  - gatsby-theme-primer-wiki-placeholder\n---\n"},{"fields":{"slug":"/","title":"å…³äºè¿™ä¸ªç«™ç‚¹"},"frontmatter":{"draft":false},"rawBody":"---\r\n\r\n---\r\n\r\n# å…³äºè¿™ä¸ªç«™ç‚¹\r\n\r\n**ğŸ‘‹Another Foam template that use [gatsby-theme-primer-wiki](https://github.com/theowenyoung/gatsby-theme-primer-wiki), Welcome to your new Foam Knowledge Base!**\r\n\r\n## Examples\r\n\r\n- [Demo](https://demo-wiki.owenyoung.com) - ([Source](https://github.com/theowenyoung/gatsby-theme-primer-wiki/tree/main/example))\r\n- [Everything I Know by Owen](https://wiki.owenyoung.com/) - ([Source](https://github.com/theowenyoung/wiki))\r\n- [Foam Demo](https://demo-foam.owenyoung.com/) - ([Source](https://github.com/theowenyoung/foam-template-gatsby-theme-primer-wiki))\r\n- [Obsidian Demo](https://demo-obsidian.owenyoung.com/) - ([Source](https://github.com/theowenyoung/obsidian-template-gatsby-theme-primer-wiki))\r\n- [Gatsby Starter Demo](https://demo-gatsby-starter-primer-wiki.owenyoung.com/) - ([Source](https://github.com/theowenyoung/gatsby-starter-primer-wiki))\r\n\r\n## Features\r\n\r\n- Support Local search, full-text search.\r\n- Support Graph Visualisation with canvas.\r\n- Support Tags, Tags First, Generating tag pages, also connecting with graph visualisation.\r\n- Support [Gitbook](https://docs.gitbook.com/integrations/github/content-configuration#summary) styled `SUMMARY.md` for custom sidebar.\r\n- Support `[[WikiLink]]`, But you'd better use [Link Reference Definitions](https://foambubble.github.io/foam/features/link-reference-definitions) with extensions, `\"foam.edit.linkReferenceDefinitions\": \"withExtensions\"`\r\n- Support Light/Dark Theme\r\n- Custom Header Nav Items\r\n- Nested sidebar\r\n- Support Google Analytics\r\n- Support Sitemap/Robot\r\n- SEO optimization\r\n- Support path prefix\r\n\r\n## Principles\r\n\r\nHere are my main ideas/principles in designing this theme.\r\n\r\n1. No vendor lock-in. The less vendor features you use, the better you'll be able to migrate. `[[Wikilink]]` is the only non-markdown feature supported by default, but nonetheless, it is recommended to use the standard markdown syntax, or if you edit with [Foam](https://github.com/foambubble/foam), please use [Wikilink](https://foambubble.github.io/foam/wikilinks) with [Link Reference Definitions](https://foambubble.github.io/foam/features/link-reference-definitions). That give us the capability change our theme, or hosted place.\r\n2. Use meta data instead of special characters. We should use `tags` as the document's metadata, not `#tag` in the plain text.\r\n3. Use tags instead of categories. Minimal subfolders.\r\n\r\n## Getting started\r\n\r\n### For new wiki\r\n\r\nThis documentation assumes that you have a GitHub account and have [Visual Studio Code](https://code.visualstudio.com/) installed on your Linux/MacOS/Windows machine.\r\n\r\n1. If you haven't yet, browse over to the main [Foam documentation](https://foambubble.github.io/foam) to get an idea of what Foam is and how to use it.\r\n2. Press \"Use this template\" button at [foam-template-gatsby-theme-primer-wiki](https://github.com/theowenyoung/foam-template-gatsby-theme-primer-wiki/generate) (that's this repository!) to fork it to your own GitHub account. If you want to keep your thoughts to yourself, remember to set the repository private.\r\n3. [Clone the repository to your local machine](https://help.github.com/en/github/creating-cloning-and-archiving-repositories/cloning-a-repository) and open it in VS Code.\r\n\r\n   _Open the repository as a folder using the `File > Open...` menu item._\r\n\r\n4. When prompted to install recommended extensions, click **Install all** (or **Show Recommendations** if you want to review and install them one by one)\r\n5. Delete all `.md` files you don't need, Change Site settings at `.layouts/gatsby-config.js`, change your CNAME at `.layouts/static/CNAME`, change your icon at `.layouts/static/logo.png`, commit your changes, and push to github, change your page settings at Github, make sure you set the page branch to `gh-pages`, then when github actions runed, you can visit your site.\r\n\r\nAfter setting up the repository, head to [[getting-started]] to get familiar with your new knowledge base!\r\n\r\nTo learn more about how to use **Foam**, read the [Recipes](https://foambubble.github.io/foam/recipes/recipes) bubbles of the Foam documentation workspace.\r\n\r\nAnd remember that you can always join our [Foam community on Discord](https://foambubble.github.io/join-discord/g)!\r\n\r\n### For exist wiki\r\n\r\n### Exist Wiki\r\n\r\n1. Clone this repo to your local machine\r\n\r\n```bash\r\ngit clone https://github.com/theowenyoung/foam-template-gatsby-theme-primer-wiki.git\r\n```\r\n\r\n2. Copy `.layouts`, `.github` `.gitignore` to your wiki folder.\r\n\r\n## Config\r\n\r\nSee [here](https://github.com/theowenyoung/gatsby-theme-primer-wiki#usage)\r\n\r\n## Local Preview\r\n\r\n```bash\r\ncd .layouts\r\nnpm i\r\nnpm start\r\n```\r\n\r\n\r\n## Deploy\r\n\r\nDeploy to Github Pages, see `.github/workflows/deploy.yml`,\r\n\r\n### Path Prefix\r\n\r\nIf you want deploy your site with prefix path, \r\n\r\n1. change `gatsby-config.js` with:\r\n\r\n```javascript\r\nmodule.exports = {\r\n  pathPrefix: `/blog`,\r\n}\r\n```\r\n\r\n2. set your build script with `gatsby build --prefix-paths`,\r\n\r\n\r\n3. Local Preview with `gatsby serve --prefix-paths`\r\n\r\n\r\nAlso see the original docs: <https://www.gatsbyjs.com/docs/how-to/previews-deploys-hosting/path-prefix/#add-to-gatsby-configjs>\r\n\r\n## Using Foam\r\n\r\nWe've created a few Bubbles (markdown documents) to get you started.\r\n\r\n- [[inbox]] - a place to write down quick notes to be categorized later\r\n- [[getting-started]] - learn how to use your Foam workspace\r\n- [[todo]] - a place to keep track of things to do\r\n\r\nIn the `docs` directory you can find everything you need to learn the basics of Foam.\r\n\r\n\r\n"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue TeamåŸºç¡€è®¾æ–½/Webåº”ç”¨é˜²ç«å¢™/WAFèƒ½åŠ›è¯„ä¼°&æµ‹è¯•/","title":"WAFèƒ½åŠ›è¯„ä¼°&æµ‹è¯•"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: WAFèƒ½åŠ›è¯„ä¼°&æµ‹è¯•\r\ntags:\r\n- Blue TeamåŸºç¡€è®¾æ–½\r\n- Webåº”ç”¨é˜²ç«å¢™\r\n- èƒ½åŠ›è¯„ä¼°\r\n---\r\n\r\n# 1. è¯„ä¼°å·¥å…·\r\nWAFèƒ½åŠ›è¯„ä¼°å·¥å…·åœ¨ä¸šç•Œéƒ½æ¯”è¾ƒå°‘è§ï¼Œä¸ºæ•°ä¸å¤šçš„å‡ ä¸ªè¿˜æ˜¯ç”±WAFä¾›åº”å•†å¼€å‘çš„ï¼Œå¦‚ï¼š\r\n\r\n- **Framework for Testing WAFs (FTW!) (https://github.com/fastly/ftw)**ï¼Œç”± ModSecurity å’Œ Fastly çš„ç ”ç©¶äººå‘˜åˆ›å»ºï¼Œæ—¨åœ¨å¸®åŠ©ä¸º WAF è§„åˆ™æä¾›ä¸¥æ ¼çš„æµ‹è¯•ã€‚å®ƒä½¿ç”¨ OWASP Core Ruleset V3 ä½œä¸ºåŸºçº¿æ¥æµ‹è¯• WAF ä¸Šçš„è§„åˆ™ã€‚è§„åˆ™é›†ä¸­çš„æ¯ä¸ªè§„åˆ™éƒ½åŠ è½½åˆ°ä¸€ä¸ª YAML æ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶å‘å‡ºå°†è§¦å‘è¿™äº›è§„åˆ™çš„ HTTP è¯·æ±‚ã€‚\r\n- **GoTestWAF(https://github.com/wallarm/gotestwaf)**ï¼Œç”±å¦ä¸€å®¶ WAF ä¾›åº”å•† Wallarm è´Ÿè´£ç»´æŠ¤ã€‚GoTestWAF ä½¿ç”¨ YAML æ¥å®šä¹‰å¤šä¸ªæµ‹è¯•ï¼Œè¿™äº›æµ‹è¯•ä½¿ç”¨ä¸åŒçš„æœ‰æ•ˆè½½è·å˜ä½“ã€ç»•è¿‡æŠ€æœ¯ã€ç¼–ç ä»¥åŠæœ‰æ•ˆè½½è·æ’å…¥ç‚¹ï¼ˆåŒ…æ‹¬æ¨¡æ‹Ÿ API è°ƒç”¨çš„ JSON ç»“æ„ï¼‰ã€‚ æœ¬æ–‡ä½¿ç”¨GoTestWAFè¿›è¡Œæµ‹è¯•ã€‚\r\n- **WAFLab(https://github.com/microsoft/waflab)**ï¼Œå¾®è½¯å‡ºå“ï¼Œä½¿ç”¨ YAML æ¥å®šä¹‰å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œé»˜è®¤ä½¿ç”¨modsecurityçš„è§„åˆ™è¿›è¡ŒéªŒè¯ã€‚\r\n\r\n# 2. GoTestWAF å¦‚ä½•å·¥ä½œï¼Ÿ\r\nGoTestWAF ç”Ÿæˆå…·æœ‰é¢„å®šä¹‰çš„åŸºæœ¬æœ‰æ•ˆè´Ÿè½½çš„è¯·æ±‚ä»¥åŠç‰¹å®šäºä¸åŒ APIï¼ˆRESTã€SOAPã€XMLRPCï¼‰çš„æ”»å‡»ã€‚ä¹‹åï¼Œå®ƒå°†å®ƒä»¬å‘é€åˆ°åº”ç”¨ç¨‹åºå¹¶åˆ†æå“åº”ä»¥åœ¨æ§åˆ¶å°è¾“å‡ºä¸­ç”Ÿæˆè¯¦ç»†æŠ¥å‘Šæˆ–ä½œä¸º PDFã€‚\r\n\r\nä¸»è¦æµ‹è¯•æ€è·¯æ˜¯å°†æ”»å‡»è½½è·ç¼–ç å¹¶æ”¾ç½®åœ¨ HTTP è¯·æ±‚çš„ä¸åŒéƒ¨åˆ†ï¼šå…¶æ­£æ–‡ã€æ ‡å¤´ã€URL å‚æ•°ç­‰ã€‚ä¸ºäº†ç®€åŒ–ï¼Œå®ç°äº†ä»¥ä¸‹é€»è¾‘ï¼š\r\n\r\n- **æœ‰æ•ˆè½½è· â†’ ç¼–ç å™¨ â†’ å ä½ç¬¦**\r\n\r\nè¿™æ„å‘³ç€æ¯ä¸ªè´Ÿè½½æ ·æœ¬ï¼ˆæ¶æ„æ”»å‡»æ ·æœ¬ï¼Œä¾‹å¦‚åƒâ€œalert(1)â€è¿™æ ·çš„ XSS å­—ç¬¦ä¸²ï¼‰å°†é¦–å…ˆä»¥æŸç§æ–¹å¼ç¼–ç ï¼Œç„¶åæ”¾å…¥ HTTP è¯·æ±‚ä¸­ã€‚è¿˜å¯ä»¥é€‰æ‹©ä½¿ç”¨ä¿æŒå­—ç¬¦ä¸²åŸæ ·çš„æ™®é€šç¼–ç å™¨ã€‚\r\n\r\nä¸ºäº†ä½¿æµ‹è¯•å¯è¯»ï¼ŒGoTestWAF ä½¿ç”¨ YAML DSLã€‚ä»¥ä¸‹æ˜¯ SQL æ³¨å…¥è´Ÿè½½çš„ç¤ºä¾‹ï¼š\r\n\r\n```\r\npayload:\r\n  '\"union select -7431.1, name, @aaa from u_base--w-'\r\n  \"'or 123.22=123.22\"\r\n  \"' waitfor delay '00:00:10'--\"\r\n  \"')) or pg_sleep(5)--\"\r\nencoder:\r\n  Base64Flat\r\n  Url  \r\nplaceholder:\r\n  UrlPath\r\n  UrlParam\r\n  JsonBody\r\n  Header\r\n```\r\n\r\nä½œä¸ºæ¯ 4 ä¸ªæœ‰æ•ˆè½½è·ã€2 ä¸ªç¼–ç å™¨å’Œ 4 ä¸ªå ä½ç¬¦çš„æ’åˆ—ç»“æœï¼Œæœ¬æ¬¡æµ‹è¯•å°†å‘é€ 424=32 ä¸ªè¯·æ±‚ã€‚\r\n\r\n# 3. WAFLab æ˜¯æ€æ ·çš„ï¼Ÿ\r\nä½¿ç”¨AutoGenæ¨¡å—è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ï¼Œå¤§ä½“æ€è·¯å’ŒGoTestWAFå·®ä¸å¤šï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œå®ƒä¼šä»Mod Securityçš„è§„åˆ™ä¸­æå–ä¿¡æ¯ï¼Œä¸è¿‡æ•´ä½“æ•°é‡è¿˜æ˜¯è›®å°‘çš„ï¼š\r\n\r\n| TYPE                                | Total Rule | Supported Rule | Passed Rule |\r\n| ----------------------------------- | ---------- | -------------- | ----------- |\r\n| METHOD-ENFORCEMENT                  | 1          | 0              | 0           |\r\n| SCANNER_DETECTION                   | 5          | 5              | 5           |\r\n| PROTOCOL-ENFORCEMENT                | 39         | 19             | 10          |\r\n| PROTOCOL-ATTACK                     | 7          |                |             |\r\n| APPLICATION-ATTACK-LFI              | 4          |                |             |\r\n| APPLICATION-ATTACK-RFI              | 4          |                |             |\r\n| APPLICATION-ATTACK-RCE              | 20         |                |             |\r\n| APPLICATION-ATTACK-PHP              | 14         |                |             |\r\n| APPLICATION-ATTACK-NODEJS           | 1          |                |             |\r\n| APPLICATION-ATTACK-XSS              | 30         |                |             |\r\n| APPLICATION-ATTACK-SQLi             | 41         |                |             |\r\n| APPLICATION-ATTACK-SESSION-FIXATION | 3          |                |             |\r\n| APPLICATION-ATTACK-JAVA             | 3          |                |             |\r\n\r\nç”Ÿæˆçš„æµ‹è¯•ç”¨ä¾‹æ ¼å¼å¦‚ä¸‹ï¼š\r\n\r\n```yaml\r\n  meta:\r\n    author: Microsoft\r\n    enabled: true\r\n    name: dev-933140.yaml\r\n    description: This YAML file is automatically generated by WAFLab AutoGen\r\n  tests:\r\n  - test_title: 933140-0\r\n    desc: REQUEST_COOKIES\r\n    stages:\r\n    - stage:\r\n        input:\r\n          stop_magic: true\r\n          dest_addr: 127.0.0.1\r\n          method: GET\r\n          port: 80\r\n          protocol: http\r\n          uri: /\r\n          version: HTTP/1.0\r\n          headers:\r\n            Cookie: O09SFeTTuD=PHP://TEMP\r\n            Host: wafdefaultruleset20.waftestdf.azfdtest.xyz\r\n        output:\r\n          status:\r\n          - 403\r\n```\r\n\r\n# 4. å‚è€ƒèµ„æ–™\r\n- [gotestwaf/README.md at master Â· wallarm/gotestwaf (github.com)](https://github.com/wallarm/gotestwaf/blob/master/README.md)\r\n- [waflab/autogen at master Â· microsoft/waflab (github.com)](https://github.com/microsoft/waflab/tree/master/autogen)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue TeamåŸºç¡€è®¾æ–½/Webåº”ç”¨é˜²ç«å¢™/é€šè¿‡æœºå™¨å­¦ä¹ æ”¹å–„ WAF/","title":"WAFèƒ½åŠ›è¯„ä¼°&æµ‹è¯•"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: WAFèƒ½åŠ›è¯„ä¼°&æµ‹è¯•\r\ntags:\r\n- Blue TeamåŸºç¡€è®¾æ–½\r\n- Webåº”ç”¨é˜²ç«å¢™\r\n- æœºå™¨å­¦ä¹ \r\n- Cloudflare\r\n---\r\n\r\n# 1. èƒŒæ™¯\r\nCloudflare æ¯ç§’å¤„ç†3200 ä¸‡æ¬¡ HTTP è¯·æ±‚ï¼Œ22% web æœåŠ¡å™¨ä¸ºÂ [W3Techs](https://w3techs.com/technologies/details/ws-cloudflare)Â æ‰€çŸ¥çš„ç½‘ç«™ä½¿ç”¨ Cloudflareã€‚Cloudflare ä¸ºäº”åˆ†ä¹‹ä¸€çš„äº’è”ç½‘èµ„äº§ä¿æŠ¤å…¶æµé‡ï¼Œå› è€Œå…·å¤‡ç‹¬ç‰¹çš„ä¼˜åŠ¿ï¼Œå¾—ä»¥åœ¨å¨èƒå‡ºç°æ—¶å°±åŠ ä»¥è¯†åˆ«ï¼Œå¹¶è·Ÿè¸ªå…¶è¿›åŒ–å’Œå˜å¼‚ã€‚\r\n\r\nWeb åº”ç”¨ç¨‹åºé˜²ç«å¢™ï¼ˆWAFï¼‰å¤„äº Cloudflare å®‰å…¨å·¥å…·ç®±çš„æ ¸å¿ƒä½ç½®ï¼Œè€Œæ‰˜ç®¡è§„åˆ™æ˜¯Â [WAF](https://www.cloudflare.com/zh-cn/learning/ddos/glossary/web-application-firewall-waf/)Â çš„å…³é”®åŠŸèƒ½ã€‚æ‰˜ç®¡è§„åˆ™æ˜¯ Cloudflare åˆ†æå¸ˆå›¢é˜Ÿåˆ›å»ºçš„ä¸€ç»„è§„åˆ™ï¼Œç”¨äºé˜»æ­¢æ˜¾ç¤ºå·²çŸ¥æ”»å‡»æ¨¡å¼çš„è¯·æ±‚ã€‚è¿™äº›æ‰˜ç®¡è§„åˆ™æ”»å‡»å¯¹äºç°æœ‰æ”»å‡»æ‰‹æ®µçš„æ¨¡å¼éå¸¸æœ‰æ•ˆï¼Œå› ä¸ºå®ƒä»¬å·²ç»è¿‡å¹¿æ³›æµ‹è¯•ï¼Œèƒ½æœ€å¤§é™åº¦å‡å°‘è¯¯æŠ¥ã€‚æ‰˜ç®¡è§„åˆ™çš„ä¸è¶³ä¹‹å¤„æ˜¯ï¼Œå¸¸å¸¸ä¼šé”™è¿‡æ”»å‡»çš„å˜ä½“ï¼ˆä¹Ÿç§°ä¸ºç»•è¿‡ï¼‰ï¼Œå› ä¸ºåŸºäºé™æ€æ­£åˆ™è¡¨è¾¾å¼çš„è§„åˆ™æœ¬è´¨ä¸Šå¯¹å¼•å…¥çš„ç‰¹å¾å˜ä½“ï¼ˆå¦‚é€šè¿‡æ¨¡ç³ŠæŠ€æœ¯ï¼‰æ•æ„Ÿã€‚\r\n\r\nåœ¨[[log4j]]æ¼æ´çˆ†å‘çš„æ—¶å€™ï¼Œç”±äºæ”»å‡»è€…å°è¯•ç»•è¿‡ WAFï¼ŒCloudflareå¿…é¡»ä¸æ–­æ›´æ–°è§„åˆ™æ¥åŒ¹é…å˜ç§ã€‚æ­¤å¤–ï¼Œä¼˜åŒ–è§„åˆ™éœ€è¦å¤§é‡çš„äººå·¥å¹²é¢„ï¼Œè€Œä¸”é€šå¸¸è¦åœ¨ç»•è¿‡è¢«è¯†åˆ«æˆ–ç”šè‡³è¢«åˆ©ç”¨åæ‰èƒ½èµ·ä½œç”¨ï¼Œå¯¼è‡´ä¿æŠ¤å˜å¾—è¢«åŠ¨ã€‚\r\n\r\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒCloudflareæä¾›ä¸€ä¸ªæ–°å·¥å…·ï¼Œæ—¨åœ¨æ— éœ€äººå·¥å¹²é¢„çš„æƒ…å†µä¸‹è¯†åˆ«ç»•è¿‡å’Œæ¶æ„è´Ÿè½½ï¼Œä»¥é˜²å…¶é€ æˆç ´åã€‚ç°åœ¨å®¢æˆ·èƒ½å¤Ÿä»ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹ä¸­è·å–ä¿¡å·ï¼Œè¿™ä¸ªæ¨¡å‹æ ¹æ®æ‰˜ç®¡è§„åˆ™å’Œåˆ†ç±»çš„å–„æ„/æ¶æ„æµé‡å’Œå¢å¼ºæ•°æ®æ¥è®­ç»ƒï¼Œä»è€Œé’ˆå¯¹æ›´å¤§èŒƒå›´çš„æ–°è€æ”»å‡»æä¾›æ›´ä½³çš„ä¿æŠ¤ã€‚\r\n\r\n# 2. ç¬¬ä¸€ä¸ªè‡ªæˆ‘å­¦ä¹ çš„ WAF\r\nå…¨æ–°æ£€æµ‹ç³»ç»Ÿå¢å¼ºç°æœ‰çš„æ‰˜ç®¡è§„åˆ™é›†ï¼Œæä¾›ä¸‰å¤§ä¼˜åŠ¿ï¼š\r\n1.  é€‚ç”¨äºæ‚¨çš„æ‰€æœ‰æµé‡ã€‚ç³»ç»Ÿä¼šæ ¹æ®æ¯ä¸ªè¯·æ±‚åŒ…å« SQLi æˆ– XSS æ”»å‡»ç­‰çš„å¯èƒ½æ€§å¯¹å…¶è¿›è¡Œè¯„åˆ†ã€‚è¿™å®ç°äº†ä¸€ç§å…¨æ–°çš„ WAF åˆ†æä½“éªŒï¼Œè®©æ‚¨èƒ½å¤Ÿæ¢ç´¢è‡ªå·±æ•´ä½“æµé‡ä¸­çš„è¶‹åŠ¿å’Œæ¨¡å¼ã€‚\r\n2.  æ£€æµ‹é€Ÿç‡æ ¹æ®è¿‡å»çš„æµé‡å’Œåé¦ˆè€Œæ”¹å–„ã€‚æ‰˜ç®¡è§„åˆ™é›†å°†æ‰€æœ‰ Cloudflare æµé‡åˆ†ç±»ä¸ºå–„æ„/æ¶æ„æµé‡åï¼Œæä¾›ç»™è¯¥æ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚è¿™æ ·ä¸€æ¥ï¼Œå°å‹ç½‘ç«™ä¹Ÿèƒ½è·å¾—ä¸å¤§å‹ç½‘ç«™åŒçº§çš„ä¿æŠ¤ã€‚\r\n3.  æ€§èƒ½çš„æ–°å®šä¹‰è¯¥æœºå™¨å­¦ä¹ æ¨¡å‹åœ¨ç»•è¿‡å’Œå¼‚å¸¸è¢«åˆ©ç”¨æˆ–è¢«äººç±»ç ”ç©¶äººå‘˜è¯†åˆ«å‰å°±å°†å…¶è¯†åˆ«å‡ºæ¥ã€‚\r\n\r\nå…¶ä¸­ç§˜è¯€åœ¨äºå¦‚ä¸‹å‡ æ–¹é¢çš„ç»“åˆï¼šåˆ›æ–°çš„æœºå™¨å­¦ä¹ å»ºæ¨¡ï¼Œåºå¤§çš„è®­ç»ƒæ•°æ®é›†ï¼ˆåŸºäºæˆ‘ä»¬æ¯å¤©é˜»æ­¢çš„æ”»å‡»ï¼Œä»¥åŠæ•°æ®å¢å¼ºæŠ€æœ¯ï¼‰ï¼ŒåŸºäºè¡Œä¸ºæµ‹è¯•åŸåˆ™çš„æ­£ç¡®è¯„ä¼°å’Œæµ‹è¯•æ¡†æ¶ï¼Œä»¥åŠè®©æˆ‘ä»¬åœ¨å‡ ä¹æ¯«ä¸å¢åŠ å»¶è¿Ÿçš„å‰æä¸‹è¯„ä¼°æ¯ä¸€ä¸ªè¯·æ±‚çš„å°–ç«¯å·¥ç¨‹æŠ€æœ¯ã€‚\r\n\r\n# 3. æ–°çš„ WAF ä½“éªŒ\r\nå…¨æ–°æ£€æµ‹ç³»ç»ŸåŸºäºä¸[æœºå™¨äººåˆ†æï¼ˆBot Analyticsï¼‰](https://blog.cloudflare.com/introducing-bot-analytics/)Â ä¸€åŒå‘å¸ƒçš„èŒƒå¼ã€‚æ ¹æ®è¿™ä¸€æ–¹æ³•ï¼Œæ— è®ºæˆ‘ä»¬æ˜¯å¦é‡‡å–è¡ŒåŠ¨ï¼Œéƒ½ä¼šå¯¹æ¯ä¸ªè¯·æ±‚è¿›è¡Œè¯„ä¼°å¹¶èµ‹åˆ†ã€‚ç”±äºæˆ‘ä»¬å¯¹æ¯ä¸€ä¸ªè¯·æ±‚èµ‹åˆ†ï¼Œé’ˆå¯¹å‘é€åˆ°ç”¨æˆ·æœåŠ¡å™¨çš„å…¨éƒ¨æµé‡ï¼Œç”¨æˆ·èƒ½å¤Ÿçœ‹åˆ°åˆ†æ•°å¦‚ä½•éšç€æ—¶é—´å˜åŒ–ã€‚\r\n\r\n![3STXCU](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/3STXCU.jpg)\r\n\r\næ­¤å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥æŸ¥çœ‹è¯·æ±‚çš„ç‰¹å®šæ”»å‡»æ‰‹æ®µï¼ˆå¦‚SQLiçš„ï¼‰è¯„åˆ†ç›´æ–¹å›¾ï¼Œå¹¶æ‰¾åˆ°åˆé€‚çš„è¯„åˆ†å€¼æ¥åŒºåˆ†å–„æ„æµé‡å’Œæ¶æ„æµé‡ã€‚é…ç½®çš„è§„åˆ™å¦‚ä¸‹å›¾ï¼š\r\n\r\n![tVmqXg](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/tVmqXg.jpg)\r\n\r\n# 4. å·¥ä½œåŸç†\r\n\r\nåŸºäºæœºå™¨å­¦ä¹ çš„æ£€æµ‹è¡¥å……äº†ç°æœ‰çš„æ‰˜ç®¡è§„åˆ™é›†ï¼Œä¾‹å¦‚ OWASP å’Œ Cloudflare æ‰˜ç®¡è§„åˆ™ã€‚è¿™å¥—ç³»ç»ŸåŸºäºæ—¨åœ¨æ²¡æœ‰ç ”ç©¶äººå‘˜æˆ–æœ€ç»ˆç”¨æˆ·ç›´æ¥ç›‘ç£çš„æƒ…å†µä¸‹è¯†åˆ«æ”»å‡»æ¨¡å¼å˜ä½“æˆ–å¼‚å¸¸çš„æ¨¡å‹ã€‚\r\n\r\næˆªè‡³ä»Šæ—¥ï¼ŒCloudflareå·²ç»å…¬å¼€ä¸¤ç§æ”»å‡»æ‰‹æ®µçš„åˆ†æ•°ï¼šSQL æ³¨å…¥ï¼ˆSQLiï¼‰å’Œè·¨ç«™ç‚¹è„šæœ¬ï¼ˆXSSï¼‰ã€‚ç”¨æˆ·èƒ½æ ¹æ®ä¸‰ä¸ªå•ç‹¬çš„åˆ†æ•°æ¥åˆ›å»ºè‡ªå®šä¹‰ WAF/é˜²ç«å¢™è§„åˆ™ï¼šæ€»åˆ† ï¼ˆ`cf.waf.ml.score`ï¼‰ï¼ŒSQLi åˆ†æ•°å’Œ XSS åˆ†æ•°ï¼ˆåˆ†åˆ«ä¸ºÂ `cf.waf.ml.score.sqli`ï¼Œ`cf.waf.ml.score.xss`,ï¼‰ã€‚è¿™äº›åˆ†æ•°ä»‹äº 1-99ï¼Œå…¶ä¸­ 1 ä¸ºç»å¯¹æ¶æ„ï¼Œ99 ä»£è¡¨æœ‰æ•ˆæµé‡ã€‚\r\n\r\n![CSU2ZS](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/CSU2ZS.jpg)\r\n\r\nç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ç°æœ‰ WAF è§„åˆ™åˆ†ç±»çš„æµé‡å¯¹è¯¥æ¨¡å‹è¿›è¡Œè®­ç»ƒï¼Œå®ƒå¯¹åŸå§‹è¯·æ±‚çš„ä¸€ä¸ªå˜å¼‚ç‰ˆæœ¬æœ‰æ•ˆï¼Œä½¿å…¶æ›´å®¹æ˜“è¯†åˆ«æ”»å‡»çš„æŒ‡çº¹ã€‚\r\n\r\nå¯¹äºæ¯ä¸ªè¯·æ±‚ï¼Œè¯¥æ¨¡å‹å¯¹è¯·æ±‚çš„æ¯ä¸ªéƒ¨åˆ†ç‹¬ç«‹è¯„åˆ†ï¼Œä»è€Œæœ‰å¯èƒ½è¯†åˆ«æ¶æ„è´Ÿè½½æ‰€åœ¨çš„ä½ç½®ï¼Œä¾‹å¦‚ï¼Œåœ¨è¯·æ±‚çš„æ­£æ–‡ã€URI æˆ–æ ‡å¤´ä¸­ã€‚\r\n\r\n![EZsUM7](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/EZsUM7.jpg)\r\n\r\nè¿™çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½† Cloudflare çš„å·¥ç¨‹å¸ˆéœ€è¦è§£å†³ä¸€ç³»åˆ—æŒ‘æˆ˜æ‰èƒ½åšåˆ°ã€‚å…¶ä¸­åŒ…æ‹¬ï¼šå¦‚ä½•å»ºç«‹ä¸€ä¸ªå¯é çš„æ•°æ®é›†ï¼Œå¯æ‰©å±•çš„æ•°æ®æ ‡ç­¾ï¼Œé€‰æ‹©æ­£ç¡®çš„æ¨¡å‹æ¶æ„ï¼Œä»¥åŠè¦æ±‚å¯¹ Cloudflare å…¨çƒç½‘ç»œå¤„ç†çš„æ¯ä¸€ä¸ªè¯·æ±‚ï¼ˆæ¯ç§’ 3200 ä¸‡ä¸ªï¼‰æ‰§è¡Œåˆ†ç±»ã€‚\r\n\r\n# 5. å‚è€ƒèµ„æ–™\r\n- [é€šè¿‡æœºå™¨å­¦ä¹ æ”¹å–„ WAF (cloudflare.com)](https://blog.cloudflare.com/zh-cn/waf-ml-zh-cn/)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue TeamåŸºç¡€è®¾æ–½/ç³»ç»Ÿè®¾è®¡/ç³»ç»Ÿè®¾è®¡åŸºç¡€çŸ¥è¯†/","title":"ç³»ç»Ÿè®¾è®¡åŸºç¡€çŸ¥è¯†"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: ç³»ç»Ÿè®¾è®¡åŸºç¡€çŸ¥è¯†\r\ntags:\r\n- Blue TeamåŸºç¡€è®¾æ–½\r\n- ç³»ç»Ÿè®¾è®¡\r\n- å®‰å…¨æ¶æ„\r\n---\r\n\r\né€‰æ‹©æ­£ç¡®çš„æ¶æ„ = é€‰æ‹©æ­£ç¡®çš„æˆ˜æ–— + ç®¡ç†æƒè¡¡\r\n\r\n# ç¬¬ä¸€æ­¥ï¼šæè¿°ä½¿ç”¨åœºæ™¯ï¼Œçº¦æŸå’Œå‡è®¾\r\næŠŠæ‰€æœ‰éœ€è¦çš„ä¸œè¥¿èšé›†åœ¨ä¸€èµ·ï¼Œå®¡è§†é—®é¢˜ã€‚ä¸åœçš„æé—®ï¼Œä»¥è‡³äºæˆ‘ä»¬å¯ä»¥æ˜ç¡®ä½¿ç”¨åœºæ™¯å’Œçº¦æŸã€‚è®¨è®ºå‡è®¾ã€‚\r\n\r\n- è°ä¼šä½¿ç”¨å®ƒï¼Ÿ\r\n- ä»–ä»¬ä¼šæ€æ ·ä½¿ç”¨å®ƒï¼Ÿ\r\n- æœ‰å¤šå°‘ç”¨æˆ·ï¼Ÿ\r\n- ç³»ç»Ÿçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ\r\n- ç³»ç»Ÿçš„è¾“å…¥è¾“å‡ºåˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\r\n- æˆ‘ä»¬å¸Œæœ›å¤„ç†å¤šå°‘æ•°æ®ï¼Ÿ\r\n- æˆ‘ä»¬å¸Œæœ›æ¯ç§’é’Ÿå¤„ç†å¤šå°‘è¯·æ±‚ï¼Ÿ\r\n- æˆ‘ä»¬å¸Œæœ›çš„è¯»å†™æ¯”ç‡ï¼Ÿ\r\n\r\n# ç¬¬äºŒæ­¥ï¼šåˆ›é€ ä¸€ä¸ªé«˜å±‚çº§çš„è®¾è®¡\r\nä½¿ç”¨æ‰€æœ‰é‡è¦çš„ç»„ä»¶æ¥æç»˜å‡ºä¸€ä¸ªé«˜å±‚çº§çš„è®¾è®¡ã€‚\r\n\r\n- ç”»å‡ºä¸»è¦çš„ç»„ä»¶å’Œè¿æ¥\r\n- è¯æ˜ä½ çš„æƒ³æ³•\r\n\r\n# ç¬¬ä¸‰æ­¥ï¼šè®¾è®¡æ ¸å¿ƒç»„ä»¶\r\nå¯¹æ¯ä¸€ä¸ªæ ¸å¿ƒç»„ä»¶è¿›è¡Œè¯¦ç»†æ·±å…¥çš„åˆ†æã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä½ è¢«é—®åˆ°[è®¾è®¡ä¸€ä¸ª url ç¼©å†™æœåŠ¡](https://github.com/donnemartin/system-design-primer/blob/master/solutions/system_design/pastebin/README.md)ï¼Œå¼€å§‹è®¨è®ºï¼š\r\n\r\nç”Ÿæˆå¹¶å‚¨å­˜ä¸€ä¸ªå®Œæ•´ url çš„ hash\r\n\r\n- MD5 å’Œ Base62\r\n- Hash ç¢°æ’\r\n- SQL è¿˜æ˜¯ NoSQL\r\n- æ•°æ®åº“æ¨¡å‹\r\n\r\nå°†ä¸€ä¸ª hashed url ç¿»è¯‘æˆå®Œæ•´çš„ url\r\n- æ•°æ®åº“æŸ¥æ‰¾\r\nAPI å’Œé¢å‘å¯¹è±¡è®¾è®¡\r\n\r\n# ç¬¬å››æ­¥ï¼šæ‰©å±•è®¾è®¡\r\nç¡®è®¤å’Œå¤„ç†ç“¶é¢ˆä»¥åŠä¸€äº›é™åˆ¶ã€‚ä¸¾ä¾‹æ¥è¯´å°±æ˜¯ä½ éœ€è¦ä¸‹é¢çš„è¿™äº›æ¥å®Œæˆæ‰©å±•æ€§çš„è®®é¢˜å—ï¼Ÿ\r\n- è´Ÿè½½å‡è¡¡\r\n- æ°´å¹³æ‰©å±•\r\n- ç¼“å­˜\r\n- æ•°æ®åº“åˆ†ç‰‡\r\n- è®ºè¿°å¯èƒ½çš„è§£å†³åŠæ³•å’Œä»£ä»·ã€‚æ¯ä»¶äº‹æƒ…éœ€è¦å–èˆã€‚å¯ä»¥ä½¿ç”¨[å¯æ‰©å±•ç³»ç»Ÿçš„è®¾è®¡åŸåˆ™](https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%BB%E9%A2%98%E7%9A%84%E7%B4%A2%E5%BC%95)æ¥å¤„ç†ç“¶é¢ˆã€‚\r\n\r\n# ç¬¬äº”æ­¥ï¼šé¢„ä¼°è®¡ç®—é‡\r\nä½ æˆ–è®¸ä¼šè¢«è¦æ±‚é€šè¿‡æ‰‹ç®—è¿›è¡Œä¸€äº›ä¼°ç®—ã€‚[é™„å½•](https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E9%99%84%E5%BD%95)æ¶‰åŠåˆ°çš„æ˜¯ä¸‹é¢çš„è¿™äº›èµ„æºï¼š\r\n- [ä½¿ç”¨é¢„ä¼°è®¡ç®—é‡](http://highscalability.com/blog/2011/1/26/google-pro-tip-use-back-of-the-envelope-calculations-to-choo.html)\r\n- [2 çš„æ¬¡æ–¹è¡¨](https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#2-%E7%9A%84%E6%AC%A1%E6%96%B9%E8%A1%A8)\r\n- [æ¯ä¸ªç¨‹åºå‘˜éƒ½åº”è¯¥çŸ¥é“çš„å»¶è¿Ÿæ•°](https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E6%AF%8F%E4%B8%AA%E7%A8%8B%E5%BA%8F%E5%91%98%E9%83%BD%E5%BA%94%E8%AF%A5%E7%9F%A5%E9%81%93%E7%9A%84%E5%BB%B6%E8%BF%9F%E6%95%B0)\r\n\r\n# ç›¸å…³èµ„æºå’Œå»¶ä¼¸é˜…è¯»\r\n- [æ€æ ·é€šè¿‡ä¸€ä¸ªç³»ç»Ÿè®¾è®¡çš„é¢è¯•](https://www.palantir.com/2011/10/how-to-rock-a-systems-design-interview/)\r\n- [ç³»ç»Ÿè®¾è®¡çš„é¢è¯•](http://www.hiredintech.com/system-design)\r\n- [ç³»ç»Ÿæ¶æ„ä¸è®¾è®¡çš„é¢è¯•ç®€ä»‹](https://www.youtube.com/watch?v=ZgdS0EUmn70)\r\n- [https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md](https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue TeamåŸºç¡€è®¾æ–½/ç½‘ç»œåŸºç¡€è®¾æ–½/åŠ å¯†æµé‡è§£å†³æ–¹æ¡ˆ/","title":"åŠ å¯†æµé‡è§£å†³æ–¹æ¡ˆ"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: åŠ å¯†æµé‡è§£å†³æ–¹æ¡ˆ\r\ntags:\r\n  - Blue TeamåŸºç¡€è®¾æ–½\r\n  - ç½‘ç»œåŸºç¡€è®¾æ–½\r\n  - åŠ å¯†æµé‡\r\n  - è¡Œä¸šå®è·µ\r\n  - Palo Alto Networks\r\n  - Extrahop\r\n  - Gigamon\r\n  - Google\r\n---\r\n\r\n# 1. åŸºç¡€çŸ¥è¯†\r\n**X.509 è¯ä¹¦ï¼š** è¯ä¹¦åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹ä¿¡ä»»ä»¥å»ºç«‹ SSL è¿æ¥ï¼Œå°è¯•å¯¹æœåŠ¡å™¨è¿›è¡Œèº«ä»½éªŒè¯ï¼ˆæˆ–å¯¹å®¢æˆ·ç«¯è¿›è¡Œèº«ä»½éªŒè¯çš„æœåŠ¡å™¨ï¼‰çš„å®¢æˆ·ç«¯çŸ¥é“ X.509 è¯ä¹¦çš„ç»“æ„ï¼Œå› æ­¤çŸ¥é“å¦‚ä½•ä»è¯ä¹¦ä¸­çš„å­—æ®µä¸­æå–æœ‰å…³æœåŠ¡å™¨çš„æ ‡è¯†ä¿¡æ¯ï¼Œä¾‹å¦‚ FQDN æˆ– IP åœ°å€ï¼ˆç§°ä¸ºè¯ä¹¦ä¸­çš„é€šç”¨åç§°æˆ–CNï¼‰æˆ–é¢å‘è¯ä¹¦çš„ç»„ç»‡ã€éƒ¨é—¨æˆ–ç”¨æˆ·çš„åç§°ã€‚è¯ä¹¦é¢å‘æœºæ„ (CA) å¿…é¡»é¢å‘æ‰€æœ‰è¯ä¹¦ã€‚CA éªŒè¯å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨åï¼ŒCA é¢å‘è¯ä¹¦å¹¶ä½¿ç”¨ç§é’¥å¯¹å…¶è¿›è¡Œç­¾åã€‚\r\n\r\n# 2. [[Palo Alto Networks]] Solution\r\n**è§£å¯†ç­–ç•¥ï¼š** é˜²ç«å¢™å¿…é¡»åœ¨å…¶è¯ä¹¦ä¿¡ä»»åˆ—è¡¨ (CTL) ä¸­æ‹¥æœ‰æœåŠ¡å™¨æ ¹ CA è¯ä¹¦ï¼Œå¹¶ä½¿ç”¨è¯¥æ ¹ CA è¯ä¹¦ä¸­åŒ…å«çš„å…¬é’¥æ¥éªŒè¯ç­¾åï¼Œç„¶åé˜²ç«å¢™æä¾›ä¸€ä»½ç”±è½¬å‘ä¿¡ä»»è¯ä¹¦ç­¾åçš„æœåŠ¡å™¨è¯ä¹¦çš„å‰¯æœ¬ï¼Œä¾›å®¢æˆ·ç«¯è¿›è¡Œèº«ä»½éªŒè¯ã€‚\r\n- **Outbound SSL trafficï¼šSSL Forward Proxy**\r\n  - é˜²ç«å¢™æ˜¯å†…éƒ¨å®¢æˆ·ç«¯å’Œå¤–éƒ¨æœåŠ¡å™¨ä¹‹é—´çš„ä¸­é—´äººã€‚é˜²ç«å¢™ä½¿ç”¨è¯ä¹¦å°†å®¢æˆ·ç«¯é€æ˜åœ°è¡¨ç¤ºç»™æœåŠ¡å™¨ï¼Œå¹¶å°†æœåŠ¡å™¨é€æ˜åœ°è¡¨ç¤ºç»™å®¢æˆ·ç«¯ï¼Œè¿™æ ·å®¢æˆ·ç«¯å°±è®¤ä¸ºå®ƒæ˜¯ç›´æ¥ä¸æœåŠ¡å™¨é€šä¿¡çš„ï¼ˆå³ä½¿å®¢æˆ·ç«¯ä¼šè¯æ˜¯ä¸é˜²ç«å¢™è¿›è¡Œçš„ï¼‰ï¼ŒæœåŠ¡å™¨ä¹Ÿç›¸ä¿¡å®ƒç›´æ¥ä¸å®¢æˆ·ç«¯é€šä¿¡ï¼ˆå³ä½¿æœåŠ¡å™¨ä¼šè¯ä¹Ÿä¸é˜²ç«å¢™ï¼‰ã€‚é˜²ç«å¢™ä½¿ç”¨è¯ä¹¦å°†è‡ªå·±å»ºç«‹ä¸ºå®¢æˆ·ç«¯-æœåŠ¡å™¨ä¼šè¯çš„å¯ä¿¡ç¬¬ä¸‰æ–¹ï¼ˆä¸­é—´äººï¼‰ã€‚\r\n  - ![dsbk1w](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2022-12/dsbk1w.jpg)\r\n- **Inbound SSL trafficï¼šSSL Inbound Inspection**\r\n  - ä¸ºè¦æ‰§è¡Œ SSL å…¥ç«™æ£€æŸ¥çš„æ¯å°æœåŠ¡å™¨å®‰è£…è¯ä¹¦å’Œç§é’¥ã€‚æ‚¨è¿˜å¿…é¡»åœ¨æ¯ä¸ªæ‰§è¡Œ SSL å…¥ç«™æ£€æŸ¥çš„é˜²ç«å¢™ä¸Šå®‰è£…å…¬é’¥è¯ä¹¦å’Œç§é’¥ã€‚é˜²ç«å¢™æ‰§è¡Œ SSL å…¥ç«™æ£€æŸ¥çš„æ–¹å¼å–å†³äºåå•†çš„å¯†é’¥ç±»å‹ã€Rivestã€Shamirã€Adleman (RSA) æˆ– Perfect Forward Secrecy ( PFS )ã€‚\r\n  - ![SNxlAy](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2022-12/SNxlAy.jpg)\r\n- **Tunneled SSH trafficï¼šSSH Proxy**\r\n  - åœ¨ SSH ä»£ç†é…ç½®ä¸­ï¼Œé˜²ç«å¢™ä½äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ã€‚SSH ä»£ç†ä½¿é˜²ç«å¢™èƒ½å¤Ÿè§£å¯†å…¥ç«™å’Œå‡ºç«™ SSH è¿æ¥ï¼Œå¹¶ç¡®ä¿æ”»å‡»è€…ä¸ä¼šä½¿ç”¨ SSH å¯¹ä¸éœ€è¦çš„åº”ç”¨ç¨‹åºå’Œå†…å®¹è¿›è¡Œéš§é“ä¼ è¾“ã€‚SSH è§£å¯†ä¸éœ€è¦è¯ä¹¦ï¼Œé˜²ç«å¢™åœ¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨ç”Ÿæˆç”¨äº SSH è§£å¯†çš„å¯†é’¥ã€‚åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œé˜²ç«å¢™ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ç°æœ‰å¯†é’¥ã€‚å¦‚æœæ²¡æœ‰ï¼Œé˜²ç«å¢™ä¼šç”Ÿæˆä¸€ä¸ªå¯†é’¥ã€‚é˜²ç«å¢™ä½¿ç”¨å¯†é’¥è§£å¯†é˜²ç«å¢™ä¸Šé…ç½®çš„æ‰€æœ‰è™šæ‹Ÿç³»ç»Ÿçš„ SSH ä¼šè¯å’Œæ‰€æœ‰ SSH v2 ä¼šè¯ã€‚\r\n\r\n# 3. [[Extrahop]] Solution\r\n**TLS 1.3å‘å±•å¸¦æ¥çš„é—®é¢˜ï¼šPerfect Forward Secrecy**\r\n- ä»¥å‰ç‰ˆæœ¬çš„ TLSï¼šä½¿ç”¨é™æ€DHå¯†é’¥äº¤æ¢ç®—æ³•å¾ˆå®¹æ˜“è§£å¯†ã€‚\r\n- TLS1.3(PFS) ä½¿ç”¨ ECDHE(Elliptic Curve Diffie-Hellman Encryption å¯†é’¥åå•†ç®—æ³•ï¼Œæ¡æ‰‹è¿‡ç¨‹ä¸­å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½éœ€è¦ä¸´æ—¶ç”Ÿæˆæ¤­åœ†æ›²çº¿å…¬ç§é’¥ï¼Œè¿™æ ·å³ä½¿ä¼šè¯å¯†é’¥è¢«æ³„éœ²ï¼Œä¹Ÿæ— æ³•è§£å¯†æ‰€æœ‰ä¼šè¯ã€‚\r\nè§£å†³æ–¹æ¡ˆï¼š\r\n- **ä¸­é—´äººåŠ«æŒï¼š** ä¸²è¡Œæ–¹æ¡ˆï¼Œè§£å¯†ï¼Œåˆ†æï¼Œç„¶åé‡æ–°åŠ å¯†ä¼ è¾“\r\n- **å¸¦å¤–ç›‘æ§ä¸è§£å¯†ï¼š** å¹¶è¡Œæ–¹æ¡ˆï¼Œæµé‡é•œåƒå®ç°\r\n\r\n\r\n**ExtraHop Reveal(x)ä½¿ç”¨å¸¦å¤–è§£å¯†æ–¹æ¡ˆ**\r\n- æ•°æ®è·å–ï¼šReveal(x) ä½¿ç”¨ Microsoft Azure vTAP æˆ– Amazon VPC æµé‡é•œåƒæ¥è·å–æ•°æ®åŒ…ã€‚\r\n- éšç§ä¿æŠ¤ï¼šéµå¾ªHIPAA, PCI, SOX, GDPRç­‰æ³•æ¡ˆï¼Œå®¢æˆ·éœ€è¦è‡ªå·±é€‰æ‹©è¦è§£å¯†çš„æµé‡ã€‚\r\n- TLS1.3æ–¹æ¡ˆï¼šExtraHop Reveal(x) ä½¿ç”¨è½»é‡çº§çš„agentè·å–æ¯ä¸ªä¼šè¯çš„ä¸´æ—¶ä¼šè¯å¯†é’¥ï¼Œè¯¥agentéœ€è¦å®‰è£…è¦è§£å¯†çš„æ¯å°æœåŠ¡å™¨ä¸Šï¼›agenté€šè¿‡ PFS åŠ å¯†é€šé“å°†è§£å¯†åçš„ä¼šè¯å®‰å…¨åœ°ä¼ è¾“åˆ° ExtraHop Reveal(x) è®¾å¤‡ï¼Œåœ¨é‚£é‡Œå®ƒä»¬è¢«å®‰å…¨å­˜å‚¨å¹¶ä¸”åªæœ‰å…·æœ‰æœ€é«˜ç®¡ç†æƒé™çš„ç”¨æˆ·æ‰èƒ½è®¿é—®ã€‚\r\n- ![wfT2AN](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2022-12/wfT2AN.jpg)\r\n\r\n# 4. [[Gigamon]] Solution\r\n![7UduQ4](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2022-12/7UduQ4.jpg)\r\n\r\n- **å…¥ç«™åŠ å¯†æµé‡ï¼š** è¯ä¹¦æ‰˜ç®¡\r\n- **å‡ºç«™åŠ å¯†æµé‡ï¼š** ä¸­é—´äººåŠ«æŒï¼ˆæœ¬åœ°ä¿¡ä»»CAï¼‰\r\n\r\n![DaE7NT](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2022-12/DaE7NT.jpg)\r\n\r\n# 5. [[Google]] Cloud IDS Solution\r\n\r\nåˆšä¸Šçº¿ä¸ä¹…ï¼Œå¯èƒ½è¿˜æœªè€ƒè™‘åˆ°åŠ å¯†æµé‡çš„æƒ…å†µ\r\n\r\n![b9GRnf](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2022-12/b9GRnf.jpg)\r\n\r\n# 6. å‚è€ƒèµ„æ–™\r\n\r\n- [https://docs.paloaltonetworks.com/pan-os/9-1/pan-os-admin/decryption/decryption-overview](https://docs.paloaltonetworks.com/pan-os/9-1/pan-os-admin/decryption/decryption-overview)\r\n- [https://www.extrahop.com/products/cloud/how-it-works](https://www.extrahop.com/products/cloud/how-it-works)\r\n- [http://blog.nsfocus.net/east-west-flow-sum](http://blog.nsfocus.net/east-west-flow-sum)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue TeamåŸºç¡€è®¾æ–½/ç½‘ç»œåŸºç¡€è®¾æ–½/ç½‘ç»œæµé‡é‡‡é›†æ–¹æ¡ˆ/","title":"ç½‘ç»œæµé‡é‡‡é›†æ–¹æ¡ˆ"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: ç½‘ç»œæµé‡é‡‡é›†æ–¹æ¡ˆ\r\ntags:\r\n- Blue TeamåŸºç¡€è®¾æ–½\r\n- ç½‘ç»œåŸºç¡€è®¾æ–½\r\n- è¡Œä¸šå®è·µ\r\n- Gigamon\r\n---\r\n\r\n# 1. åŸºç¡€çŸ¥è¯†\r\nä¸¤ç§æœ€å¸¸è§çš„ç½‘ç»œæµé‡é‡‡é›†æ–¹æ³•æ˜¯ç½‘ç»œåˆ†è·¯å™¨(TAPs) å’Œäº¤æ¢æœºç«¯å£é•œåƒ(SPANs):\r\n**1.1. ç½‘ç»œåˆ†è·¯å™¨(TAPs)**\r\nä¸€ç§ç›´æ¥è¿æ¥åˆ°ç½‘ç»œåŸºç¡€è®¾æ–½çš„ç‰©ç†è®¾å¤‡ã€‚ TAP ä½äºä¸¤ä¸ªè®¾å¤‡ä¹‹é—´ï¼Œè€Œä¸æ˜¯ä¸¤ä¸ªäº¤æ¢æœºæˆ–è·¯ç”±å™¨ä¹‹é—´ï¼›å¹¶è¡Œæ–¹æ¡ˆï¼Œé€šè¿‡æ‹·è´æµé‡å‰¯æœ¬è¿›è¡Œç›‘æ§ï¼Œä¸å½±å“åŸå§‹ç½‘ç»œé€šè®¯ï¼Œè¿™ç§æŠ€æœ¯ç¡®ä¿ä»»ä½•å¤§å°çš„æ•°æ®åŒ…éƒ½å°†è¢«æ‹·è´å¹¶ä¸”**ä¸å®¹æ˜“è¶…è½½**ã€‚\r\nå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒWebæœåŠ¡å™¨å’Œäº¤æ¢æœºä¹‹é—´çš„æµé‡æ•°æ®è¢«TAPè®¾å¤‡æ•è·æ‹·è´(TxA:A->B, TxB:B->A)ï¼Œå¤§å¤šæ•°TAPè®¾å¤‡åˆ†åˆ«å¤åˆ¶ä¸¤ä¸ªæ–¹å‘çš„æµé‡æ•°æ®ï¼Œå¹¶å°†å®ƒä»¬å‘é€åˆ°å•ç‹¬çš„ç›‘æ§ç«¯å£ï¼ˆTxAå’ŒTxBï¼‰\r\n![qTtJbp](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2022-12/qTtJbp.jpg)\r\n\r\n**1.2. äº¤æ¢æœºç«¯å£é•œåƒ(SPANs)**\r\nSPAN ç«¯å£ï¼ˆæœ‰æ—¶ç§°ä¸ºé•œåƒç«¯å£ï¼‰æ˜¯ä¸€ç§å†…ç½®äºäº¤æ¢æœºæˆ–è·¯ç”±å™¨çš„è½¯ä»¶åŠŸèƒ½ï¼Œå¯æ‹·è´é€šè¿‡è®¾å¤‡çš„é€‰å®šæµé‡æ•°æ®åŒ…çš„å‰¯æœ¬ï¼Œå¹¶å°†å®ƒä»¬å‘é€åˆ°æŒ‡å®šçš„ SPAN ç«¯å£ã€‚ ç”±äºäº¤æ¢æœºæˆ–è·¯ç”±å™¨çš„ä¸»è¦ç›®çš„æ˜¯è½¬å‘ç”Ÿäº§æ•°æ®åŒ…ï¼Œå› æ­¤ SPAN æ•°æ®åœ¨è®¾å¤‡ä¸Šçš„ä¼˜å…ˆçº§è¾ƒä½ï¼ŒSPAN è¿˜ä½¿ç”¨å•ä¸ªå‡ºå£ç«¯å£æ¥èšåˆå¤šä¸ªé“¾è·¯ï¼Œå› æ­¤**å¾ˆå®¹æ˜“è¶…è½½**ã€‚SPAN æœ€é€‚åˆåœ¨æœªå®‰è£… TAP çš„ä½ç½®å¯¹å°‘é‡æ•°æ®è¿›è¡Œä¸´æ—¶ç›‘æ§ã€‚ï¼ˆæ³¨ï¼šSPAN ä»ç„¶æ˜¯è®¿é—®æŸäº›ç±»å‹æ•°æ®çš„å”¯ä¸€æ–¹å¼ï¼Œä¾‹å¦‚åœ¨åŒä¸€äº¤æ¢æœºä¸Šè·¨ç«¯å£åˆ°ç«¯å£çš„æ•°æ®ï¼‰\r\n\r\n![xKSTiK](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2022-12/xKSTiK.jpg)\r\n\r\n# 2. ä¸œè¥¿å‘æµé‡é‡‡é›†\r\nä¼ ç»ŸTAPå’ŒSPANçš„æ–¹æ¡ˆåœ¨ä¸œè¥¿å‘æµé‡é‡‡é›†æœ‰ä¸¤ä¸ªéš¾ç‚¹ï¼š**1ã€æ— æ³•é‡‡é›†åŒä¸€å®¿ä¸»æœºå†…çš„ä¸¤å°è™šæ‹Ÿæœºä¹‹é—´çš„æµé‡ã€‚2ã€å°è£…äº†vxlanç­‰éš§é“åŒ…å¤´çš„æ•°æ®æµé‡æ— æ³•è¯†åˆ«**ã€‚\r\n\r\nä¸šç•Œä¸»æµçš„æ–¹æ¡ˆæœ‰ï¼ˆTAP/SPANçš„åŸºç¡€ä¸Šï¼‰ï¼š\r\n- SDNï¼šé€šè¿‡SDNæ§åˆ¶å™¨çš„å…¨ç½‘æ§åˆ¶èƒ½åŠ›ï¼Œå®ç°ä¸œè¥¿å‘æµé‡é‡‡é›†\r\n- APIæ¥å£ï¼šé€šè¿‡è°ƒç”¨äº‘è®¡ç®—ç³»ç»Ÿçš„æ ‡å‡†å¼•æµAPIï¼Œå®ç°ä¸œè¥¿å‘æµé‡é‡‡é›†\r\n- ä»£ç†ï¼šéSDNç½‘ç»œä¸‹ï¼Œæ·»åŠ ä¸€ä¸ªå¼•æµçš„ä»£ç†ï¼Œå®ç°ä¸œè¥¿å‘æµé‡é‡‡é›†\r\n- Agentï¼šé€šè¿‡åœ¨ç»ˆç«¯éƒ¨ç½²è½¯ä»¶æ¥å®ç°ä¸œè¥¿å‘æµé‡é‡‡é›†\r\n- vxlanï¼šåœ¨è™šæœºä¸Šåšé•œåƒï¼ŒæŠŠæµé‡é€šè¿‡vxlanå¯¼å‡ºå»ï¼Œé€åˆ°ä¸€å°æ”¯æŒvxlanç»ˆç»“çš„äº¤æ¢æœºä¸Šå»ï¼Œè¿™å°äº¤æ¢æœºæŠŠvxlanå‰¥ç¦»åï¼Œé€ç»™æ—æŒ‚çš„è®¾å¤‡è¿›è¡Œæµé‡é‡‡é›†\r\n\r\n# 3. Gigamon Solution\r\n- **æ— æºTAP**\r\n  - æ— æºTAPæ˜¯åœ¨å…¶ç½‘ç»œç«¯å£ä¹‹é—´æ²¡æœ‰ç‰©ç†éš”ç¦»çš„è®¾å¤‡ï¼Œå®ƒä»ç½‘ç»œçš„ä¸¤ä¸ªæ–¹å‘æ¥æ”¶æµé‡ï¼Œä»¥ä¾¿åœ¨ç›‘è§†å·¥å…·ä¸Šçœ‹åˆ°100ï¼…çš„æµé‡ã€‚æ— æºTAPä¸éœ€è¦ä»»ä½•ç”µæºï¼Œå¢åŠ äº†ä¸€å±‚å†—ä½™ï¼Œå‡ ä¹ä¸éœ€è¦ç»´æŠ¤ï¼Œå¹¶å‡å°‘äº†æ€»è´¹ç”¨ã€‚\r\n- **æœ‰æºTAP**\r\n  - æœ‰æºTAPåœ¨ç½‘ç»œç«¯å£ä¹‹é—´å…·æœ‰ç‰©ç†éš”ç¦»ã€‚å› æ­¤ï¼Œå®ƒä»¬éœ€è¦ä¸€ç§æ•…éšœå®‰å…¨æœºåˆ¶ï¼Œä»¥ç¡®ä¿åœ¨TAPæ–­ç”µæ—¶ç½‘ç»œä¿æŒå¯æ“ä½œçŠ¶æ€ï¼›**æœ‰æºTAPé€šå¸¸åœ¨ä¸‹é¢çš„åœºæ™¯ä½¿ç”¨ï¼ˆæ— æºTAPä¸é€‚ç”¨ï¼‰**ï¼š\r\n    1. Locations where the light levels are too low to use a splitter â†’ regeneration provides a viable solution\r\n    2. Copper infrastructures â†’ where electricity is used to move electrons (instead of photons)\r\n    3. Signal conversions â†’ since an active TAP regenerates the signal anyway, it can also be designed to create a signal of a different type (such as 10Gb SR converted to 10Gb LR)\r\n    4. SFP-based links that cannot otherwise be broken (such as TwinAX cabling) â†’ regeneration works here as well\r\n- **è™šæ‹ŸTAP**\r\n  - ç”¨äºç½‘ç»œåŠŸèƒ½è™šæ‹ŸåŒ– (NFV) ä»¥åŠç§æœ‰å’Œå…¬å…±äº‘åŸºç¡€æ¶æ„ï¼Œä»¥è®¿é—®æ‰˜ç®¡ç¯å¢ƒä¸­çš„ä¸œè¥¿å‘å’Œå—åŒ—å‘æµé‡ã€‚\r\n  - ![hKxsTy](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2022-12/hKxsTy.jpg)\r\n\r\n# 4. å‚è€ƒèµ„æ–™\r\n- [https://www.gigamon.com/resources/resource-library/white-paper/to-tap-or-to-span.html](https://www.gigamon.com/resources/resource-library/white-paper/to-tap-or-to-span.html)\r\n- [https://www.gigamon.com/resources/resource-library/white-paper/understanding-network-taps-first-step-to-visibility.html](https://www.gigamon.com/resources/resource-library/white-paper/understanding-network-taps-first-step-to-visibility.html)\r\n- [https://www.secrss.com/articles/12651](https://www.secrss.com/articles/12651)\r\n- [http://blog.nsfocus.net/east-west-flow-sum](http://blog.nsfocus.net/east-west-flow-sum)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue Teamèƒ½åŠ›å»ºè®¾/å‘½ä»¤ä¸æ§åˆ¶ C2/DNS Tunneléš§é“æ£€æµ‹/","title":"DNS Tunneléš§é“æ£€æµ‹"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: DNS Tunneléš§é“æ£€æµ‹\r\ntags:\r\n- Blue Teamèƒ½åŠ›å»ºè®¾\r\n- å‘½ä»¤ä¸æ§åˆ¶ C2\r\n- DNS\r\n---\r\n\r\n# 1. é˜…è¯»ç›®å½•(Content)\r\n- DNSéš§é“ç®€ä»‹\r\n  - DNSéš§é“æœ¨é©¬åˆ†ç±»\r\n    - IPç›´è¿å‹ DNSéš§é“æœ¨é©¬\r\n    - åŸŸåå‹ DNSéš§é“æœ¨é©¬ - DNSè¿­ä»£æŸ¥è¯¢ä¸­ç»§éš§é“\r\n    - IPç›´è¿å‹å’ŒåŸŸåè§£æå‹å¼‚åŒç‚¹\r\n- Powershell+dnscat2å®ç°DNSéšè”½éš§é“åå¼¹Shell\r\n  - C&CåŸŸåç»‘å®š\r\n  - åœ¨C&CæœåŠ¡å™¨ä¸Šå®‰è£…DNS C&C Server\r\n  - éƒ¨ç½²å®¢æˆ·ç«¯dnscat2 client\r\n  - è¿æ¥å»ºç«‹åï¼ŒC&Cæ§åˆ¶ç«¯å¯ä»¥æ‰§è¡ŒæŒ‡ä»¤\r\n    - è·å–shell\r\n    - ç«¯å£è½¬å‘\r\n  - wiresharkæŠ“åŒ…åˆ†æ\r\n    - UDPç›´è¿æ¨¡å¼\r\n    - åŸŸåè§£ææ¨¡å‹\r\n- å¯ç”¨äºDNS tunnelçš„æ£€æµ‹æ€è·¯ - åŸºäºUDP DNSä¼šè¯\r\n  - DNS query typeæˆåˆ†ç»„æˆå¼‚å¸¸æ£€æµ‹\r\n    - DNS Tunnel\r\n    - DNS FF Botnet\r\n    - DNS Query types Numbers\r\n  - åŸºäºZipfå®šå¾‹çš„å¼‚å¸¸æ£€æµ‹ - Frequency Analysis\r\n  - DNS query/answeræ–‡æœ¬ç‰¹å¾\r\n    - n-gramæ–‡æœ¬ç‰¹å¾\r\n    - åŸºäºCNNæ·±åº¦ç¥ç»ç½‘ç»œï¼Œä»æ–‡æœ¬è§’åº¦åˆ¤æ–­å•æ¡DNS queryæ˜¯å¦å­˜åœ¨å¯ç–‘Tunnelç‰¹å¾\r\n    - Query/Answeré•¿åº¦ç‰¹å¾\r\n  - åŸºäºä¼šè¯èšç±»ç»´åº¦çš„DNS tunnelè¡Œä¸ºç‰¹å¾\r\n    - DNSä¼šè¯æ—¶é•¿\r\n    - DNSä¼šè¯ä¸­æ•°æ®åŒ…æ€»æ•°\r\n    - â€œä¸Šè¡Œå¤§åŒ…â€å è¯·æ±‚æŠ¥æ–‡æ€»æ•°çš„æ¯”ä¾‹\r\n    - â€œä¸‹è¡Œå°åŒ…â€å å“åº”æŠ¥æ€»æ•°çš„æ¯”ä¾‹\r\n    - æœ‰æ•ˆè½½è·çš„ä¸Šä¼ ä¸‹è½½æ¯”\r\n    - æœ‰æ•ˆè½½è·éƒ¨åˆ†æ˜¯å¦åŠ å¯†\r\n    - åŸŸåå¯¹åº”çš„ä¸»æœºåæ•°é‡\r\n    - FQDNæ•°å¼‚å¸¸æ£€æµ‹\r\n    - æ€»çš„query æŠ¥æ–‡Payloadè½½è·é‡\r\n  - å“åº”æ—¶é—´ç›¸å…³ç‰¹å¾\r\n    - Response wait timeç‰¹å¾\r\n  - ä¿¡æ¯ç†µ\r\n  - å‘åŒ…é¢‘ç‡è¡Œä¸º\r\n- å¯ç”¨äºDNS tunnelçš„æ£€æµ‹æ€è·¯ - åŸºäºDNS QUERYç»´åº¦\r\n  - Network Features - ç½‘ç»œè®¿é—®è¡Œä¸ºæ–¹é¢çš„ç‰¹å¾\r\n    - åŸŸåè¢«è®¿é—®é¢‘ç‡è§’åº¦ç‰¹å¾\r\n    - TTL (last seen - first seen)\r\n    - window\r\n    - dns name change frequency\r\n  - Lexical Features\r\n    - åŸŸåæœ¬èº«è¯é¢‘ç‰¹å¾å±‚é¢ç‰¹å¾\r\n    - åŸŸåçš„é¦™ä¾¬ç†µ\r\n    - å­—ç¬¦åˆ†å¸ƒç‰¹å¾ -å¯è¯»æ€§/æ˜“è¯»æ€§æ–¹é¢çš„ä½“ç°\r\n  - DNS sessionä¼šè¯ç›¸å…³ç‰¹å¾\r\n    - Number of IP subnetworks\r\n    - DNSå¯¹åº”çš„src_ip/dst_ip countç›¸å…³ç‰¹å¾\r\n    - DNS query typeç»„æˆæˆåˆ†ç›¸å…³ç‰¹å¾\r\n  - DNSåŸŸåç›¸å…³metaä¿¡æ¯\r\n    - whois-based features\r\n- å¼‚å¸¸æ•°æ®æ¸…æ´—\r\n  - åŸºçº¿å¼‚å¸¸è¿‡æ»¤æ€è·¯\r\n  - æ— ç›‘ç£å¼‚å¸¸abnormalæ£€æµ‹ç®—æ³•\r\n\r\n# 2. å‚è€ƒèµ„æ–™\r\n- [https://www.cnblogs.com/LittleHann/p/8656621.html](https://www.cnblogs.com/LittleHann/p/8656621.html)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue Teamèƒ½åŠ›å»ºè®¾/å‘½ä»¤ä¸æ§åˆ¶ C2/åŸºäºç»Ÿè®¡å­¦çš„C2æµé‡æ£€æµ‹/","title":"åŸºäºç»Ÿè®¡å­¦çš„C2æµé‡æ£€æµ‹"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: åŸºäºç»Ÿè®¡å­¦çš„C2æµé‡æ£€æµ‹\r\ntags:\r\n- Blue Teamèƒ½åŠ›å»ºè®¾\r\n- å‘½ä»¤ä¸æ§åˆ¶ C2\r\n- æµé‡æ£€æµ‹\r\n---\r\n\r\n# 1. åŸºç¡€ç»Ÿè®¡å­¦çŸ¥è¯†\r\n- ä¸­ä½æ•°\r\n  - ä¸­ä½æ•°æ˜¯æƒ³è¦è¡¨ç¤ºä¸€ä¸ªæ•°æ®é›†ä¸­é—´ä½ç½®çš„æ•°æ®ã€‚\r\n    - `æ¯”å¦‚ä¸€ç»„æ•°å­— (1, 1, 2, 2, 4, 6, 9) çš„ä¸­ä½æ•°ä¸º 2`\r\n\r\n- ç»å¯¹ä¸­ä½å·®\r\n  - ä¸­ä½æ•°æ˜¯æƒ³è¦è¡¨ç¤ºä¸€ä¸ªæ•°æ®é›†ä¸­é—´ä½ç½®çš„æ•°æ®ï¼Œé‚£ä¹ˆæ¯ä¸ªæ•°æ®ä¸ä¸­ä½æ•°çš„å·®å€¼ï¼Œåæ˜ äº†è¿™äº›æ•°æ®åç¦»ä¸­é—´ä½ç½®çš„ç¨‹åº¦ï¼Œåœ¨è¿™ä¸ªåç¦»ç¨‹åº¦ä¸­å–ä¸­ä½æ•°å¾—åˆ°çš„å°±æ˜¯ç»å¯¹ä¸­ä½å·®ã€‚\r\n\r\n    ```\r\n      æ¯”å¦‚ä¸€ç»„æ•°å­— (1, 1, 2, 2, 4, 6, 9) çš„ä¸­ä½æ•°ä¸º 2\r\n      è¿™ç»„æ•°å­—ç›¸å¯¹äº2çš„åå·®ä¸ºï¼š(1, 1, 0, 0, 2, 4, 7)ï¼Œä¸­ä½æ•°ä¸º 1\r\n      æ‰€ä»¥ç»å¯¹ä¸­ä½å·®ä¸º 1\r\n    ```\r\n\r\n- ååº¦\r\n  - è¡¡é‡éšæœºå˜é‡æ¦‚ç‡åˆ†å¸ƒçš„ä¸å¯¹ç§°æ€§ï¼Œæ˜¯ç›¸å¯¹äºå¹³å‡å€¼ä¸å¯¹ç§°ç¨‹åº¦çš„åº¦é‡ï¼Œé€šè¿‡å¯¹ååº¦ç³»æ•°çš„æµ‹é‡ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ¤å®šæ•°æ®åˆ†å¸ƒçš„ä¸å¯¹ç§°ç¨‹åº¦ä»¥åŠæ–¹å‘ã€‚\r\n  - ![fv5E4Y](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/fv5E4Y.jpg)\r\n  - ååº¦çš„è¡¡é‡æ˜¯ç›¸å¯¹äºæ­£æ€åˆ†å¸ƒæ¥è¯´ï¼Œæ­£æ€åˆ†å¸ƒçš„ååº¦ä¸º0ï¼Œå³è‹¥æ•°æ®åˆ†å¸ƒæ˜¯å¯¹ç§°çš„ï¼Œååº¦ä¸º0ã€‚è‹¥ååº¦å¤§äº0ï¼Œåˆ™åˆ†å¸ƒå³åï¼ˆæ­£ååº¦ï¼‰ï¼Œå³åˆ†å¸ƒæœ‰ä¸€æ¡é•¿å°¾åœ¨å³ï¼›è‹¥ååº¦å°äº0ï¼Œåˆ™åˆ†å¸ƒä¸ºå·¦åï¼ˆè´Ÿååº¦ï¼‰ï¼Œå³åˆ†å¸ƒæœ‰ä¸€æ¡é•¿å°¾åœ¨å·¦ï¼ˆå¦‚ä¸Šå›¾ï¼‰ï¼›åŒæ—¶ååº¦çš„ç»å¯¹å€¼è¶Šå¤§ï¼Œè¯´æ˜åˆ†å¸ƒçš„åç§»ç¨‹åº¦è¶Šä¸¥é‡ã€‚\r\n\r\n# 2. C2æµé‡vsæ­£å¸¸æµé‡\r\nå‡è®¾beaconçš„é…ç½®ä¸ºï¼š\r\n| Sleepæ—¶é—´ | jitter | å®é™…sleepæ—¶é—´ |\r\n| --------- | ------ | ------------- |\r\n| 300s      | 20%    | 240s~360s     |\r\n\r\n\t- è®¿é—®çš„æ—¶é—´é—´éš”ä¸º240s-360s\r\n\r\nå‡è®¾æ­£å¸¸ç”¨æˆ·éšæœºæµè§ˆç›¸åŒç½‘é¡µ\r\n- è®¿é—®çš„æ—¶é—´é—´éš”ä¸º60s-600s\r\n- åŸºäºä¸Šè¿°çš„å‡è®¾å’Œç»Ÿè®¡å­¦çŸ¥è¯†ï¼Œå¯ä»¥ç”»å‡ºå›¾ï¼š\r\n  - ![gQKyp4](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/gQKyp4.jpg)\r\n- beaconä¸­ä½æ•°ï¼ˆMedianï¼‰: 319\r\n- æ­£å¸¸ç”¨æˆ·ä¸­ä½æ•°ï¼ˆMedianï¼‰: 236\r\n- beaconç»å¯¹ä¸­ä½å·®ï¼ˆMADï¼‰: 21\r\n- æ­£å¸¸ç”¨æˆ·ç»å¯¹ä¸­ä½å·®ï¼ˆMADï¼‰: 95\r\n\r\nå¯ä»¥å¾—å‡ºç»“è®ºï¼š\r\n- **beaconï¼šåæ­£æ€åˆ†å¸ƒï¼Œç»å¯¹ä¸­ä½å·®æ¯”è¾ƒå°**\r\n- **æ­£å¸¸ç”¨æˆ·ï¼šåæ­£/è´Ÿååº¦åˆ†å¸ƒï¼Œç»å¯¹ä¸­ä½å·®æ¯”è¾ƒå¤§**\r\n\r\nå‚è€ƒRITA (Real Intelligence Threat Analytics)çš„ç®—æ³•ï¼Œé€šè¿‡è¯·æ±‚çš„æ—¶é—´é—´éš”å’Œæ•°æ®åŒ…å¤§å°çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œå¾—å‡ºå¯ç–‘çš„C2çš„è¯·æ±‚:\r\n- ååº¦\r\n- ç»å¯¹ä¸­ä½å·®\r\n- é¢‘ç‡\r\n\r\nå®ç°çš„ä»£ç ç‰‡æ®µå¦‚ä¸‹\r\n\r\n```go\r\n//è®¡ç®—ååº¦\r\n//store the diff slice length\r\ndiffLength := len(diff)\r\n\r\n//diffLength-1 is used since diff is a zero based slice\r\ntsLow := diff[util.Round(.25*float64(diffLength-1))]\r\ntsMid := diff[util.Round(.5*float64(diffLength-1))]\r\ntsHigh := diff[util.Round(.75*float64(diffLength-1))]\r\ntsBowleyNum := tsLow + tsHigh - 2*tsMid\r\ntsBowleyDen := tsHigh - tsLow\r\n\r\n//tsSkew should equal zero if the denominator equals zero\r\n//bowley skew is unreliable if Q2 = Q1 or Q2 = Q3\r\nif tsBowleyDen != 0 && tsMid != tsLow && tsMid != tsHigh {\r\n\ttsSkew = float64(tsBowleyNum) / float64(tsBowleyDen)\r\n}\r\n\r\n//è®¡ç®—ç»å¯¹ä¸­ä½å·®\r\ntsMadm := devs[util.Round(.5*float64(diffLength-1))]\r\n\r\n//è®¡ç®—é¢‘ç‡\r\nbucketDivs, freqList, freqCount, histScore := getTsHistogramScore(a.tsMin, a.tsMax, res.TsList)\r\n```\r\n\r\n# 3. å‚è€ƒèµ„æ–™\r\n- [https://infosecjupyterthon.com/2021/sessions/day2-5-C2_Beaconing_Detection_using_Statistical_Analysis.html](https://infosecjupyterthon.com/2021/sessions/day2-5-C2_Beaconing_Detection_using_Statistical_Analysis.html)\r\n- [https://github.com/activecm/rita](https://github.com/activecm/rita)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue Teamèƒ½åŠ›å»ºè®¾/å¨èƒæ£€æµ‹è§„åˆ™/Elastic Rules/","title":"Elastic Rules"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: Elastic Rules\r\ntags:\r\n- Blue Teamèƒ½åŠ›å»ºè®¾\r\n- å¨èƒæ£€æµ‹è§„åˆ™\r\n- Elastic\r\n---\r\n\r\n# 1. ä»‹ç»\r\nå†…ç½®100+æ£€æµ‹è§„åˆ™å¯ç›´æ¥ä½¿ç”¨ï¼Œå¦‚ä¸‹å›¾ï¼š\r\n![nDBkDF](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/nDBkDF.jpg)\r\n\r\n\r\n# 2. æ¡ˆä¾‹\r\næ£€æµ‹è®¡åˆ’ä»»åŠ¡ï¼ˆscheduled taskï¼‰æ˜¯å¦è¢«åˆ›å»º\r\n\r\n- **Rule type**ï¼šEQL\r\n- **Rule indices**:\r\n  - winlogbeat-*\r\n  - logs-system.*\r\n- **Severity**ï¼šLow\r\n- **Risk score**ï¼š21\r\n- **Runs every**ï¼š5 min\r\n- **Searches indices from**ï¼šnow-9m\r\n- **Maximum alerts per execution**ï¼š100\r\n- **References**ï¼šhttps://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4698\r\n- **Potential false positives**ï¼šå®‰è£…æ–°è½¯ä»¶æ—¶ï¼Œä¹Ÿå¯èƒ½è§¦å‘åˆ›å»ºåˆæ³•çš„è®¡åˆ’ä»»åŠ¡\r\n- è§„åˆ™ï¼š\r\n\r\n```\r\niam where event.action == \"scheduled-task-created\" and /* excluding \r\ntasks created by the computer account */ not user.name : \"*$\" and\r\n/* TaskContent is not parsed, exclude by full taskname noisy ones */\r\nnot winlog.event_data.TaskName : (\"\\\\OneDrive Standalone\r\nUpdate Task-S-1-5-21*\", \"\\\\Hewlett-Packard\\\\HP Web\r\nProducts Detection\", \"\\\\Hewlett-Packard\\\\HPDeviceCheck\")\r\n```\r\n\r\n- **Framework**: MITRE ATT&CKTM\r\n  - Tactic:\r\n    - Name: Persistence\r\n    - ID: TA0003\r\n    - Reference URL: [https://attack.mitre.org/tactics/TA0003/](https://attack.mitre.org/tactics/TA0003/)\r\n  - Technique:\r\n    - Name: Scheduled Task/Job\r\n    - ID: T1053\r\n    - Reference URL: [https://attack.mitre.org/techniques/T1053/](https://attack.mitre.org/techniques/T1053/)\r\n\r\n# 3. å‚è€ƒèµ„æ–™\r\n- [https://www.elastic.co/guide/en/security/current/prebuilt-rules.html](https://www.elastic.co/guide/en/security/current/prebuilt-rules.html)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue Teamèƒ½åŠ›å»ºè®¾/å¨èƒæ£€æµ‹è§„åˆ™/SIGMA Rules/","title":"SIGMA Rules"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: SIGMA Rules\r\ntags:\r\n- Blue Teamèƒ½åŠ›å»ºè®¾\r\n- å¨èƒæ£€æµ‹è§„åˆ™\r\n- SIGMA\r\n---\r\n\r\n# 1. ä»‹ç»\r\nä¸€ç§é€šç”¨ä¸”å¼€æ”¾çš„åŸºäºç­¾åçš„è§„åˆ™æ ¼å¼ï¼Œå¯ä»¥ç›´æ¥æè¿°ç›¸å…³çš„æ—¥å¿—äº‹ä»¶ã€‚è§„åˆ™æ ¼å¼éå¸¸çµæ´»ï¼Œæ˜“äºç¼–å†™ï¼Œé€‚ç”¨äºä»»ä½•ç±»å‹çš„æ—¥å¿—æ–‡ä»¶ã€‚ä¸»è¦ç›®çš„æ˜¯æä¾›ä¸€ç§ç»“æ„åŒ–çš„å½¢å¼ï¼Œç ”ç©¶äººå‘˜æˆ–åˆ†æäººå‘˜å¯ä»¥åœ¨å…¶ä¸­æè¿°ä»–ä»¬æ›¾ç»å¼€å‘çš„æ£€æµ‹æ–¹æ³•ï¼Œå¹¶ä½¿å…¶ä¸ä»–äººå…±äº«ã€‚\r\n\r\nSigmaæ”¯æŒä¸»æµçš„SIEMå·¥å…·ã€‚å®ƒæœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š\r\n\r\n- å®ƒä½¿åˆ†æèƒ½å¤Ÿåœ¨ç»„ç»‡ä¹‹é—´é‡å¤ä½¿ç”¨å’Œå…±äº«ã€‚\r\n- é«˜çº§é€šç”¨åˆ†æè¯­è¨€\r\n- è§£å†³è®°å½•ç­¾åé—®é¢˜ç­‰æœ€å¯é çš„æ–¹æ³•\r\n- çº¯æ–‡æœ¬YAMLæ–‡ä»¶\r\n\r\n# 2. ç›¸å…³Presentation\r\n[https://github.com/Neo23x0/Talks/blob/master/Sigma_Hall_of_Fame_20211022.pdf](https://github.com/Neo23x0/Talks/blob/master/Sigma_Hall_of_Fame_20211022.pdf)\r\n\r\n# 3. ä¸¾ä¾‹ï¼šCVE-2009-3898çš„Sigmaè§„åˆ™\r\n```\r\n  title: Suspicious PsExec Execution\r\n  id: c462f537-a1e3-41a6-b5fc-b2c2cef9bf82\r\n  description: detects execution of psexec or paexec with renamed service name, this rule helps to filter out the noise if psexec is used for legit purposes or if attacker\r\n      uses a different psexec client other than sysinternal one\r\n  author: Samir Bousseaden\r\n  date: 2019/04/03\r\n  references:\r\n      - https://blog.menasec.net/2019/02/threat-hunting-3-detecting-psexec.html\r\n  tags:\r\n      - attack.lateral_movement\r\n      - attack.t1077\r\n  logsource:\r\n      product: windows\r\n      service: security\r\n      description: 'The advanced audit policy setting \"Object Access > Audit Detailed File Share\" must be configured for Success/Failure'\r\n  detection:\r\n      selection1:\r\n          EventID: 5145\r\n          ShareName: \\\\*\\IPC$\r\n          RelativeTargetName:\r\n           - '*-stdin'\r\n           - '*-stdout'\r\n           - '*-stderr'\r\n      selection2:\r\n          EventID: 5145\r\n          ShareName: \\\\*\\IPC$\r\n          RelativeTargetName: 'PSEXESVC*'\r\n      condition: selection1 and not selection2\r\n  falsepositives:\r\n      - nothing observed so far\r\n  level: high\r\n```\r\n\r\n# 4. é¡¹ç›®åœ°å€\r\n- [https://github.com/SigmaHQ/sigma](https://github.com/SigmaHQ/sigma)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue Teamèƒ½åŠ›å»ºè®¾/å¨èƒæ£€æµ‹è§„åˆ™/Splunk Rules/","title":"Splunk Rules"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: Splunk Rules\r\ntags:\r\n- Blue Teamèƒ½åŠ›å»ºè®¾\r\n- å¨èƒæ£€æµ‹è§„åˆ™\r\n- Splunk\r\n---\r\n\r\n# 1. ä»‹ç»\r\nSplunkæä¾›æ˜ å°„åˆ°ATT&CK/KILL CHAIN/CIS Controls TTPsç›¸å…³çš„USE CASEå’Œæ£€æµ‹è§„åˆ™ï¼Œ å®ƒä»¬åŒ…æ‹¬æ£€æµ‹è§„åˆ™ã€æœç´¢è¯­æ³•ã€æœºå™¨å­¦ä¹ ç®—æ³•å’Œ Splunk Phantom å‰§æœ¬â€”â€”æ‰€æœ‰è¿™äº›éƒ½æ—¨åœ¨ååŒå·¥ä½œä»¥æ£€æµ‹ã€è°ƒæŸ¥å’Œå“åº”å¨èƒã€‚\r\n\r\n# 2. è¦†ç›–èŒƒå›´\r\nè¦æŸ¥çœ‹ä½¿ç”¨ATT&CKæ ‡è®°çš„æ‰€æœ‰å†…å®¹çš„æœ€æ–°æ£€æµ‹è¦†ç›–å›¾ï¼Œè¯·è®¿é—®ï¼š[https://mitremap.splunkresearch.com](https://mitremap.splunkresearch.com) åŒ…å«ç›®å‰æ£€æµ‹è¦†ç›–èŒƒå›´çš„æŠ€æœ¯çš„å¿«ç…§ã€‚ è“è‰²çš„é˜´å½±è¶Šæ·±ï¼Œå¯¹è¿™ç§ç‰¹å®šæŠ€æœ¯çš„æ£€æµ‹å°±è¶Šå¤šï¼›è¯¥åœ°å›¾åœ¨æ¯æ¬¡å‘å¸ƒæ—¶è‡ªåŠ¨æ›´æ–°ï¼Œå¹¶ä» generate-coverage-map.py ç”Ÿæˆã€‚\r\n\r\n# 3. æ£€æµ‹è§„åˆ™\r\nåŒ…å«äº†ç»ˆç«¯ã€ç½‘ç»œå’Œäº‘ç›¸å…³çš„200å¤šç§æ£€æµ‹è§„åˆ™ï¼Œç¤ºä¾‹å¦‚ä¸‹:\r\n\r\n```\r\n  name: Eventvwr UAC Bypass\r\n  id: 9cf8fe08-7ad8-11eb-9819-acde48001122\r\n  version: 1\r\n  date: '2021-03-01'\r\n  author: Michael Haag, Splunk\r\n  type: TTP\r\n  datamodel:\r\n  - Endpoint\r\n  description: The following search identifies Eventvwr bypass by identifying the registry\r\n    modification into a specific path that eventvwr.msc looks to (but is not valid)\r\n    upon execution. A successful attack will include a suspicious command to be executed\r\n    upon eventvwr.msc loading. Upon triage, review the parallel processes that have\r\n    executed. Identify any additional registry modifications on the endpoint that may\r\n    look suspicious. Remediate as necessary.\r\n  search: '| tstats `security_content_summariesonly` count values(Registry.registry_key_name)\r\n    as registry_key_name values(Registry.registry_path) as registry_path min(_time)\r\n    as firstTime max(_time) as lastTime FROM datamodel=Endpoint.Registry where  Registry.registry_path=\"*mscfile\\\\shell\\\\open\\\\command\\\\*\"  by\r\n    Registry.user, Registry.dest , Registry.registry_value_name| `security_content_ctime(lastTime)`\r\n    | `security_content_ctime(firstTime)` | `drop_dm_object_name(Registry)` | `eventvwr_uac_bypass_filter`'\r\n  how_to_implement: To successfully implement this search you need to be ingesting information\r\n    on process that include the name of the process responsible for the changes from\r\n    your endpoints into the `Endpoint` datamodel in the `Registry` node.\r\n  known_false_positives: Some false positives may be present and will need to be filtered.\r\n  references:\r\n  - https://blog.malwarebytes.com/malwarebytes-news/2021/02/lazyscripter-from-empire-to-double-rat/\r\n  - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1548.002/T1548.002.md\r\n  - https://attack.mitre.org/techniques/T1548/002\r\n  - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/\r\n  tags:\r\n    analytic_story:\r\n    - Windows Defense Evasion Tactics\r\n    - IcedID\r\n    automated_detection_testing: passed\r\n    confidence: 100\r\n    context:\r\n    - Source:Endpoint\r\n    - Stage:Defense Evasion\r\n    dataset:\r\n    - https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1548.002/atomic_red_team/windows-sysmon.log\r\n    impact: 80\r\n    kill_chain_phases:\r\n    - Exploitation\r\n    - Privilege Escalation\r\n    message: Registry values were modified to bypass UAC using Event Viewer on $dest$\r\n      by $user$.\r\n    mitre_attack_id:\r\n    - T1548.002\r\n    - T1548\r\n    observable:\r\n    - name: user\r\n      type: User\r\n      role:\r\n      - Victim\r\n    - name: dest\r\n      type: Hostname\r\n      role:\r\n      - Victim\r\n    product:\r\n    - Splunk Enterprise\r\n    - Splunk Enterprise Security\r\n    - Splunk Cloud\r\n    required_fields:\r\n    - _time\r\n    - Registry.registry_key_name\r\n    - Registry.registry_path\r\n    - Registry.user\r\n    - Registry.dest\r\n    - Registry.registry_value_name\r\n    risk_score: 80\r\n    security_domain: endpoint\r\n```\r\n\r\nå®Œæ•´å†…å®¹è§ï¼š\r\n  - [https://github.com/splunk/security_content/tree/develop/detections](https://github.com/splunk/security_content/tree/develop/detections)\r\n\r\n# 4. USE CASEs\r\n- ProxyShellçš„ç¤ºä¾‹å¦‚ä¸‹:\r\n\r\n  ```\r\n    name: ProxyShell\r\n    id: 413bb68e-04e2-11ec-a835-acde48001122\r\n    version: 1\r\n    date: '2021-08-24'\r\n    author: Michael Haag, Teoderick Contreras, Mauricio Velazco, Splunk\r\n    type: batch\r\n    description: ProxyShell is a chain of exploits targeting on-premise Microsoft Exchange Server - CVE-2021-34473, CVE-2021-34523, and CVE-2021-31207.\r\n    narrative: 'During Pwn2Own April 2021, a security researcher demonstrated an attack chain targeting on-premise Microsoft Exchange Server. August 5th, the same researcher publicly released further details and demonstrated the attack chain. \\\r\n      1. CVE-2021-34473 - Pre-auth path confusion leads to ACL Bypass (Patched in April by KB5001779) \\\r\n      1. CVE-2021-34523 - Elevation of privilege on Exchange PowerShell backend (Patched in April by KB5001779) \\\r\n      1. CVE-2021-31207 - Post-auth Arbitrary-File-Write leads to RCE (Patched in May by KB5003435) \\\r\n      Upon successful exploitation, the remote attacker will have `SYSTEM` privileges on the Exchange Server. In addition to remote access/execution, the adversary may be able to run Exchange PowerShell Cmdlets to perform further actions.'\r\n    references:\r\n      - https://y4y.space/2021/08/12/my-steps-of-reproducing-proxyshell/\r\n      - https://www.zerodayinitiative.com/blog/2021/8/17/from-pwn2own-2021-a-new-attack-surface-on-microsoft-exchange-proxyshell\r\n      - https://www.youtube.com/watch?v=FC6iHw258RI\r\n      - https://www.huntress.com/blog/rapid-response-microsoft-exchange-servers-still-vulnerable-to-proxyshell-exploit#what-should-you-do\r\n      - https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-ProxyLogon-Is-Just-The-Tip-Of-The-Iceberg-A-New-Attack-Surface-On-Microsoft-Exchange-Server.pdf\r\n    tags:\r\n      analytic_story:\r\n      - ProxyShell\r\n      category:\r\n      - Adversary Tactics\r\n      - Ransomware\r\n      product:\r\n      - Splunk Enterprise\r\n      - Splunk Enterprise Security\r\n      - Splunk Cloud\r\n      usecase: Advanced Threat Detection\r\n  ```\r\n\r\n# 5. æ”»å‡»æ ·æœ¬æ•°æ® Attack Data Repository\r\n- æ— éœ€å‡†å¤‡æ”»å‡»ç¯å¢ƒ/å·¥å…·ï¼Œ å¿«é€ŸéªŒè¯æ£€æµ‹è§„åˆ™çš„è¦†ç›–å’Œæœ‰æ•ˆæ€§ã€‚\r\n- æ•°æ®ä½¿ç”¨YMLï¼Œæ ¼å¼å¦‚ä¸‹ï¼š\r\n\r\n| å­—æ®µ        | æè¿°             |\r\n| ----------- | ---------------- |\r\n| id          | å”¯ä¸€æ ‡è¯†UUID     |\r\n| name        | ä½œè€…åç§°         |\r\n| date        | æœ€åä¿®æ”¹æ—¥æœŸ     |\r\n| dataset     | datasetå…³è”URLs  |\r\n| description | ç®€ä»‹             |\r\n| environment | è¿è¡Œç¯å¢ƒ         |\r\n| technique   | å¯¹åº”çš„ATT&CKæ‰‹æ³• |\r\n| references  | å‚è€ƒä¿¡æ¯         |\r\n| sourcetypes | æ¥æºç±»å‹         |\r\n\r\nç¤ºä¾‹å¦‚ä¸‹:\r\n\r\n```\r\nid: 405d5889-16c7-42e3-8865-1485d7a5b2b6\r\nauthor: Patrick Bareiss\r\ndate: '2020-10-08'\r\ndescription: 'Atomic Test Results: Successful Execution of test T1003.001-1 Windows\r\nCredential Editor Successful Execution of test T1003.001-2 Dump LSASS.exe Memory\r\nusing ProcDump Return value unclear for test T1003.001-3 Dump LSASS.exe Memory using\r\ncomsvcs.dll Successful Execution of test T1003.001-4 Dump LSASS.exe Memory using\r\ndirect system calls and API unhooking Return value unclear for test T1003.001-6\r\nOffline Credential Theft With Mimikatz Return value unclear for test T1003.001-7\r\nLSASS read with pypykatz '\r\nenvironment: attack_range\r\ntechnique:\r\n- T1003.001\r\ndataset:\r\n- https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.001/atomic_red_team/windows-powershell.log\r\n- https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.001/atomic_red_team/windows-security.log\r\n- https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.001/atomic_red_team/windows-sysmon.log\r\n- https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1003.001/atomic_red_team/windows-system.log\r\nreferences:\r\n- https://attack.mitre.org/techniques/T1003/001/\r\n- https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.001/T1003.001.md\r\n- https://github.com/splunk/security-content/blob/develop/tests/T1003_001.yml\r\nsourcetypes:\r\n- XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\r\n- WinEventLog:Microsoft-Windows-PowerShell/Operational\r\n- WinEventLog:System\r\n- WinEventLog:Security\r\n```\r\n\r\n# 6. å‚è€ƒèµ„æ–™\r\n- [https://github.com/splunk/attack_data](https://github.com/splunk/attack_data)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue TeamåŸºç¡€è®¾æ–½/ç»ˆç«¯åŸºç¡€è®¾æ–½/EDRå•†ä¸šåŒ–äº§å“/CrowdStrike Falcon/","title":"CrowdStrike Falcon"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: CrowdStrike Falcon\r\ntags:\r\n- Blue TeamåŸºç¡€è®¾æ–½\r\n- ç»ˆç«¯åŸºç¡€è®¾æ–½\r\n- EDRå•†ä¸šåŒ–äº§å“\r\n- CrowdStrike\r\n---\r\n\r\n# 1. CrowdStrike EDR è§£å†³æ–¹æ¡ˆä¸­æœ€é‡è¦çš„æ˜¯ä»€ä¹ˆï¼Ÿ\r\n![NsTQNy](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/NsTQNy.jpg)\r\n\r\n- **æ‰¾åˆ°èƒ½å¤Ÿæä¾›æœ€é«˜çº§åˆ«çš„ä¿æŠ¤åŒæ—¶éœ€è¦æœ€å°‘çš„åŠªåŠ›å’ŒæŠ•èµ„çš„ EDR å®‰å…¨è§£å†³æ–¹æ¡ˆéå¸¸é‡è¦**â€”â€”åœ¨ä¸è€—å°½èµ„æºçš„æƒ…å†µä¸‹ä¸ºæ‚¨çš„å®‰å…¨å›¢é˜Ÿå¢åŠ ä»·å€¼ã€‚ä»¥ä¸‹æ˜¯æ‚¨åº”è¯¥å¯»æ‰¾çš„ EDR çš„å…­ä¸ªå…³é”®æ–¹é¢ï¼š\r\n\r\n  - **å¯è§åº¦ï¼š**è·¨æ‰€æœ‰ç»ˆç«¯çš„å®æ—¶å¯è§æ€§ï¼Œä»è€Œå¯ä»¥æ£€æµ‹å‘ç°æ”»å‡»è€…æ´»åŠ¨ï¼Œè¿›è€Œå®æ–½é˜»æ–­ã€‚\r\n  - **å¨èƒæ•°æ®åº“ï¼š**EDR éœ€è¦ä»ç»ˆç«¯æ”¶é›†å¤§é‡é¥æµ‹æ•°æ®å¹¶ä¸°å¯Œä¸Šä¸‹æ–‡ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å„ç§åˆ†ææŠ€æœ¯æŒ–æ˜æ”»å‡»è¿¹è±¡ã€‚\r\n  - **è¡Œä¸ºä¿æŠ¤ï¼š**ä»…ä¾èµ–åŸºäºç­¾åæˆ–IOCä¼šå¯¼è‡´æ£€æµ‹èƒ½åŠ›è¢«è½»æ˜“ç»•è¿‡ï¼Œä»è€Œå¯¼è‡´æ•°æ®æ³„éœ²ï¼›EDRéœ€è¦èƒ½é€šè¿‡è¡Œä¸ºæ¥æœç´¢æ”»å‡»æŒ‡æ ‡ (IOAsï¼Œcrowdstrikeå‘æ˜çš„)ï¼Œä»¥ä¾¿åœ¨å‘ç”Ÿå±å®³ä¹‹å‰æ”¶åˆ°å¯ç–‘æ´»åŠ¨çš„å‘Šè­¦ã€‚\r\n\r\n- TODO > ä»€ä¹ˆæ˜¯æ”»å‡»æŒ‡æ ‡ Indicators of attack (IOA)ï¼Ÿ\r\n  æ”»å‡»æŒ‡æ ‡ (IOA)ä¾§é‡äºæ£€æµ‹æ”»å‡»è€…è¯•å›¾å®Œæˆçš„ç›®æ ‡çš„æ„å›¾ï¼Œè€Œä¸ç®¡æ”»å‡»ä¸­ä½¿ç”¨çš„æ¶æ„è½¯ä»¶æˆ–æ¼æ´ã€‚å°±åƒæ€æ¯’è½¯ä»¶çš„ç­¾åä¸€æ ·ï¼ŒåŸºäº IOC çš„æ£€æµ‹æ–¹æ³•æ— æ³•æ£€æµ‹åˆ°0dayæ”»å‡»å’Œå…æ€æ¶æ„è½¯ä»¶ã€‚\r\n\r\n  >æ¯”å¦‚é±¼å‰æ”»å‡»ï¼Œå¿…é¡»æ¬ºéª—ç›®æ ‡ç‚¹å‡»é“¾æ¥æˆ–æ‰“å¼€æ¶æ„æ–‡ä»¶/æ–‡æ¡£ï¼Œä¸€æ—¦æœºå™¨æ²¦é™·ï¼Œæ”»å‡»è€…å°†é»˜é»˜åœ°æ‰§è¡Œå¦ä¸€ä¸ªè¿›ç¨‹ï¼Œéšè—åœ¨å†…å­˜æˆ–ç£ç›˜ä¸­ï¼Œå¹¶åœ¨ç³»ç»Ÿé‡æ–°å¯åŠ¨åç»´æŒæƒé™ï¼›ç„¶åä¸C2è”ç³»ï¼Œç­‰å¾…è¿›ä¸€æ­¥çš„æŒ‡ç¤ºã€‚\r\n  >\r\n  >IOA å…³æ³¨è¿™äº›å…·ä½“æ­¥éª¤çš„æ‰§è¡Œã€å¯¹æ‰‹çš„æ„å›¾ä»¥åŠä»–è¯•å›¾å®ç°çš„ç»“æœã€‚IOAå¹¶ä¸å…³æ³¨ä»–ç”¨æ¥å®ç°ç›®æ ‡çš„ç‰¹å®šå·¥å…·ï¼Œè€Œå®ç›‘æ§å…³é”®è¡ŒåŠ¨ï¼Œé€šè¿‡æœ‰çŠ¶æ€æ‰§è¡Œæ£€æŸ¥å¼•æ“(Stateful Execution Inspection Engine)æ¥æ”¶é›†å’Œä½¿ç”¨æŒ‡æ ‡(indicators )ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šæ”»å‡»è€…å¦‚ä½•æˆåŠŸè®¿é—®ç½‘ç»œå¹¶æ¨æ–­å…¶æ„å›¾ã€‚\r\n\r\n  - **æ´å¯ŸåŠ›å’Œæ™ºæ…§ï¼š**é›†æˆå¨èƒæƒ…æŠ¥çš„EDRè§£å†³æ–¹æ¡ˆå¯ä»¥æä¾›ä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬æ”»å‡»æ‚¨çš„ç‰¹å®šå¯¹æ‰‹çš„è¯¦ç»†ä¿¡æ¯æˆ–æœ‰å…³æ”»å‡»çš„å…¶ä»–ä¿¡æ¯ã€‚\r\n  - **å¿«é€Ÿå“åº”ï¼š**EDRèƒ½å¤Ÿå¯¹äº‹ä»¶åšå‡ºå¿«é€Ÿå‡†ç¡®çš„å“åº”ï¼Œå¯ä»¥åœ¨æ”»å‡»é€ æˆå½±å“ä¹‹å‰é˜»æ­¢æ”»å‡»ï¼Œå¹¶å¿«é€Ÿæ¢å¤ä¸šåŠ¡ã€‚\r\n  - **åŸºäºäº‘ï¼š**åŸºäºäº‘çš„EDRè§£å†³æ–¹æ¡ˆå¯ä»¥é™ä½å¯¹ç»ˆç«¯çš„å½±å“ï¼ŒåŒæ—¶ç¡®ä¿å¯ä»¥å‡†ç¡®ã€å®æ—¶åœ°å®Œæˆæœç´¢ã€åˆ†æå’Œè°ƒæŸ¥ç­‰åŠŸèƒ½ã€‚\r\n\r\n# 2. CrowdStrike EDR æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ\r\n- EDRè§£å†³æ–¹æ¡ˆçš„å·¥ä½œåŸç†æ˜¯æä¾›å¯¹ç»ˆç«¯ä¸Šå‘ç”Ÿäº‹æƒ…çš„æŒç»­å’Œå…¨é¢çš„å®æ—¶æ£€æµ‹/ç›‘æ§ã€‚ç„¶åå°†è¡Œä¸ºåˆ†æå’Œå¯æ“ä½œçš„æƒ…æŠ¥åº”ç”¨äºç»ˆç«¯æ•°æ®ï¼Œä»¥é˜»æ­¢æ”»å‡»å‘Šè­¦æ¼”å˜ä¸ºå®‰å…¨äº‹ä»¶ã€‚åŠŸèƒ½åŒ…æ‹¬ï¼š\r\n  - **1. è‡ªåŠ¨å‘ç°æœªçŸ¥æ”»å‡»è€…**\r\n    - Falcon Insight å°†æ‰€æœ‰ç»ˆç«¯çš„é¥æµ‹æ•°æ®ä¸IOAé…å¯¹ï¼Œå¹¶ä½¿ç”¨å…¶è¡Œä¸ºæ¥åˆ†ææ•°åäº¿äº‹ä»¶ï¼Œè‡ªåŠ¨æ£€æµ‹å¯ç–‘è¡Œä¸ºçš„ç—•è¿¹ï¼›å¦‚æœä¸€ç³»åˆ—äº‹ä»¶å’Œå‘Šè­¦ä¸å·²çŸ¥ IOAåŒ¹é…ï¼Œagentå°†æŠŠè¯¥æ´»åŠ¨æ ‡è®°ä¸ºæ¶æ„å¹¶è‡ªåŠ¨å‘é€å‘Šè­¦ï¼›ç”¨æˆ·è¿˜å¯ä»¥ç¼–å†™è‡ªå·±çš„æœç´¢æ¡ä»¶ï¼ŒFalcon Insightçš„äº‘æ¶æ„å¯åœ¨5 ç§’æˆ–æ›´çŸ­çš„æ—¶é—´å†…è¿”å›æŸ¥è¯¢ç»“æœã€‚\r\n  - **2. ä¸å¨èƒæƒ…æŠ¥é›†æˆ**\r\n    - å¯ä»¥æ›´å¿«åœ°æ£€æµ‹è¢«è¯†åˆ«ä¸ºæ¶æ„çš„TTPsï¼Œå¹¶æä¾›äº†ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬ç›¸å…³çš„å½’å› ï¼Œæä¾›æœ‰å…³æ”»å‡»è€…çš„è¯¦ç»†ä¿¡æ¯ä»¥åŠæœ‰å…³æ”»å‡»çš„ä»»ä½•å…¶ä»–ä¿¡æ¯ã€‚\r\n  - **3. ä¸»åŠ¨é˜²å¾¡ï¼Œæ‰˜ç®¡å¼å¨èƒç‹©çŒ**\r\n    - ä½œä¸º Falcon å¹³å°çš„ä¸€éƒ¨åˆ†ï¼ŒFalcon OverWatchâ„¢ æ‰˜ç®¡å¨èƒè¿½è¸ªæœåŠ¡å¢åŠ äº†ä¸€ä¸ªé¢å¤–çš„ä¿æŠ¤èƒ½åŠ›ï¼Œå®‰å…¨ä¸“å®¶ä¼šå¸®åŠ©å®¢æˆ·é‡‡å–è¡ŒåŠ¨ï¼Œä»¥ç¡®ä¿ä¸ä¼šé—æ¼å¨èƒï¼Œå¹¶æœ€ç»ˆé˜²æ­¢å‘ç”Ÿå¤§è§„æ¨¡æ³„éœ²ã€‚\r\n  - **4. æä¾›å®æ—¶/å†å²çš„å¯è§æ€§**\r\n    - Falcon Insightå°±åƒç»ˆç«¯ä¸Šçš„ DVRï¼Œè®°å½•ç›¸å…³æ´»åŠ¨ä»¥æ•æ‰å°è¯•ç»•è¿‡æ£€æµ‹çš„å®‰å…¨äº‹ä»¶ï¼›Falcon agentè·Ÿè¸ªäº†æ•°ç™¾ä¸ªä¸åŒçš„å®‰å…¨ç›¸å…³äº‹ä»¶ï¼Œä¾‹å¦‚è¿›ç¨‹åˆ›å»ºã€é©±åŠ¨ç¨‹åºåŠ è½½ã€æ³¨å†Œè¡¨ä¿®æ”¹ã€ç£ç›˜è®¿é—®ã€å†…å­˜è®¿é—®æˆ–ç½‘ç»œè¿æ¥ç­‰ï¼Œå®¢æˆ·å¯ä»¥ä»å®‰å…¨è§’åº¦å…¨é¢äº†è§£å…¶ç»ˆç«¯ä¸Šå‘ç”Ÿçš„ä¸€åˆ‡ã€‚\r\n    - è¿™ä¸ºå®‰å…¨å›¢é˜Ÿæä¾›äº†ä»–ä»¬éœ€è¦çš„æœ‰ç”¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š\r\n      - å†…å¤–ä¸å¤–éƒ¨çš„ç½‘ç»œè¿æ¥\r\n      - ç›´æ¥/è¿œç¨‹ç™»å½•çš„æ‰€æœ‰ç”¨æˆ·å¸æˆ·\r\n      - ASP å¯†é’¥çš„å˜æ›´ã€å¯æ‰§è¡Œæ–‡ä»¶å’Œç®¡ç†å·¥å…·çš„ä½¿ç”¨\r\n      - è¿›ç¨‹æ‰§è¡Œ\r\n      - è¯¦ç»†çš„è¿›ç¨‹çº§åˆ«çš„ç½‘ç»œæ´»åŠ¨ï¼ŒåŒ…æ‹¬ DNS è¯·æ±‚ã€è¿æ¥å’Œå¼€æ”¾ç«¯å£\r\n      - å­˜æ¡£æ–‡ä»¶åˆ›å»ºï¼ŒåŒ…æ‹¬ RAR å’Œ ZIPS\r\n      - USBç­‰å¤–éƒ¨å­˜å‚¨ä»‹è´¨\r\n  - **5. åŠ é€Ÿè°ƒæŸ¥**\r\n    - èƒ½å¤ŸåŠ å¿«è°ƒæŸ¥å’Œæœ€ç»ˆä¿®å¤çš„é€Ÿåº¦ï¼Œå› ä¸ºä»ç»ˆç«¯æ”¶é›†çš„ä¿¡æ¯é€šè¿‡Falcon å¹³å°å­˜å‚¨åœ¨ CrowdStrike äº‘ä¸­ï¼Œä½¿ç”¨äº†ä¸€ä¸ªå›¾å½¢æ•°æ®åº“æ¥è·Ÿè¸ªæ¯ä¸ªç»ˆç«¯äº‹ä»¶ä¹‹é—´çš„æ‰€æœ‰å…³ç³»å’Œè”ç³»ï¼Œè¯¥æ•°æ®åº“å¯ä»¥å¿«é€Ÿã€å¤§è§„æ¨¡åœ°æä¾›å†å²å’Œå®æ—¶æ•°æ®çš„è¯¦ç»†ä¿¡æ¯å’Œä¸Šä¸‹æ–‡ï¼Œè¿™ä½¿å®‰å…¨å›¢é˜Ÿèƒ½å¤Ÿæœ‰æ•ˆåœ°è·Ÿè¸ªå³ä½¿æ˜¯æœ€å¤æ‚çš„æ”»å‡»ï¼Œå¹¶åŠæ—¶å‘ç°äº‹ä»¶ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œåˆ†ç±»ã€éªŒè¯å’Œç¡®å®šä¼˜å…ˆçº§ï¼Œä»è€Œæ›´å¿«ã€æ›´ç²¾ç¡®åœ°è¿›è¡Œè¡¥æ•‘ã€‚\r\n  - **6. å®ç°å¿«é€Ÿçš„ä¿®å¤**\r\n    - Falcon Insight å¯ä»¥éš”ç¦»ç»ˆç«¯ï¼Œå®ƒå…è®¸ç»„ç»‡é€šè¿‡å°†å¯èƒ½å—åˆ°å¨èƒçš„ä¸»æœºä¸æ‰€æœ‰ç½‘ç»œæ´»åŠ¨éš”ç¦»å¼€æ¥é‡‡å–è¿…é€Ÿå’Œå³æ—¶çš„è¡ŒåŠ¨ã€‚å½“ç»ˆç«¯å—è¢«éš”ç¦»ï¼Œå®ƒä»ç„¶å¯ä»¥ä» CrowdStrike äº‘å‘é€å’Œæ¥æ”¶ä¿¡æ¯ï¼Œä½†å³ä½¿ä¸äº‘çš„è¿æ¥è¢«åˆ‡æ–­ï¼Œå®ƒä»å°†ä¿æŒè¢«éš”ç¦»ï¼Œå¹¶åœ¨é‡æ–°å¯åŠ¨æœŸé—´ä¿æŒè¿™ç§éš”ç¦»çŠ¶æ€ã€‚\r\n    - **åœ¨åº”å¯¹æ–°å‡ºç°çš„å¨èƒæ—¶ï¼Œæ—¶é—´è‡³å…³é‡è¦ï¼Œå“åº”è€…éœ€è¦å®æ—¶ã€æ·±å…¥çš„å¯è§æ€§ï¼Œä»¥ä¾¿ä»–ä»¬èƒ½å¤Ÿå¿«é€Ÿæœæ–­åœ°è¿›è¡Œè¡¥æ•‘ã€‚**\r\n    - **ä¿¡æ¯æ”¶é›†å™¨**å…è®¸å®‰å…¨å›¢é˜Ÿé€šè¿‡æ‰§è¡Œä»¥ä¸‹ä»»åŠ¡ï¼Œä»¥äº†è§£å¨èƒçš„é£é™©å’ŒèŒƒå›´ï¼š\r\n      - æµè§ˆæ–‡ä»¶ç³»ç»Ÿå¹¶æå–æ–‡ä»¶\r\n      - åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹\r\n      - æå– Windows äº‹ä»¶æ—¥å¿—\r\n      - æŸ¥è¯¢ Windows æ³¨å†Œè¡¨\r\n      - åˆ—å‡ºå½“å‰çš„ç½‘ç»œè¿æ¥å’Œé…ç½®\r\n      - æå–è¿›ç¨‹å†…å­˜\r\n      - è®¡ç®—æ–‡ä»¶å“ˆå¸Œ\r\n      - æ”¶é›†ç¯å¢ƒå˜é‡\r\n      - ä½¿ç”¨ PowerShell æˆ–å…¶ä»–å·¥å…·æ”¶é›†å…¶ä»–æ‰€éœ€ä¿¡æ¯\r\n    - **è¡¥æ•‘æªæ–½**ä½¿å›¢é˜Ÿèƒ½å¤Ÿè¿…é€Ÿè€Œæœæ–­åœ°é‡‡å–è¡ŒåŠ¨æ¥éåˆ¶æˆ–è¡¥æ•‘å¨èƒï¼ŒåŒ…æ‹¬ï¼š\r\n      - åˆ é™¤æ–‡ä»¶\r\n      - ç»“æŸä¸€ä¸ªè¿›ç¨‹\r\n      - åˆ é™¤æˆ–ä¿®æ”¹ Windows æ³¨å†Œè¡¨é¡¹æˆ–å€¼\r\n      - ä¸Šä¼ æ–‡ä»¶\r\n      - è¿è¡Œè„šæœ¬æˆ–å¯æ‰§è¡Œæ–‡ä»¶\r\n      - åŠ å¯†æ–‡ä»¶\r\n      - é‡å¯/å…³æœº\r\n- å€ŸåŠ© CrowdStrike çš„äº‘åŸç”Ÿæ¶æ„ã€è½»é‡çº§agentå’Œç»Ÿä¸€æ§åˆ¶å°ï¼Œå®æ—¶å“åº”åŠŸèƒ½å¯ä»¥äº¤ä»˜åˆ°ä¸–ç•Œä¸Šä»»ä½•åœ°æ–¹çš„ä»»ä½•ç³»ç»Ÿï¼Œè€Œå¯¹æˆæœ¬æˆ–æ€§èƒ½çš„å½±å“å‡ ä¹ä¸ºé›¶ã€‚\r\n\r\n# 3. å‚è€ƒèµ„æ–™\r\n- [https://www.crowdstrike.com/cybersecurity-101/indicators-of-compromise/ioa-vs-ioc/](https://www.crowdstrike.com/cybersecurity-101/indicators-of-compromise/ioa-vs-ioc/)\r\n- [https://www.crowdstrike.com/cybersecurity-101/endpoint-security/endpoint-detection-and-response-edr/](https://www.crowdstrike.com/cybersecurity-101/endpoint-security/endpoint-detection-and-response-edr/)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue TeamåŸºç¡€è®¾æ–½/ç»ˆç«¯åŸºç¡€è®¾æ–½/EDR/2021 EPPé­”åŠ›è±¡é™ EPP Magic Quadrant/","title":"2021 EPPé­”åŠ›è±¡é™ EPP Magic Quadrant"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: 2021 EPPé­”åŠ›è±¡é™ EPP Magic Quadrant\r\ntags:\r\n- Blue TeamåŸºç¡€è®¾æ–½\r\n- ç»ˆç«¯åŸºç¡€è®¾æ–½\r\n- EDR\r\n---\r\n\r\n![https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/ZP3Qyi.jpg](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/ZP3Qyi.jpg)\r\n\r\n# 1. å¸‚åœºè¶‹åŠ¿\r\n- åˆ° 2023 å¹´åº•ï¼Œäº‘äº¤ä»˜çš„ EPP è§£å†³æ–¹æ¡ˆå°†è¶…è¿‡ 95% ã€‚\r\n- åˆ° 2025 å¹´ï¼Œ50% ä½¿ç”¨ EDR çš„ç»„ç»‡å°†ä½¿ç”¨æ‰˜ç®¡æ£€æµ‹å’Œå“åº”åŠŸèƒ½ï¼ˆMDRï¼‰ã€‚\r\n- åˆ° 2025 å¹´ï¼Œ60% çš„ EDR è§£å†³æ–¹æ¡ˆå°†åŒ…å«æ¥è‡ªå¤šä¸ªå®‰å…¨æ§åˆ¶æºçš„æ•°æ®ï¼Œä¾‹å¦‚èº«ä»½è®¤è¯ã€CASB å’Œ DLPã€‚\r\n\r\n# 2. å¸‚åœºå®šä¹‰/æè¿°\r\n- Gartnerå¯¹EPPå¸‚åœºçš„å®šä¹‰å¦‚ä¸‹ï¼šEPPæä¾›äº†å°†agentæˆ–sensoréƒ¨ç½²åˆ°æ‰˜ç®¡ç»ˆç«¯ï¼ˆåŒ…æ‹¬ PCã€æœåŠ¡å™¨å’Œå…¶ä»–è®¾å¤‡ï¼‰çš„å·¥å…·ï¼›è¿™äº›æ—¨åœ¨é˜²æ­¢ä¸€ç³»åˆ—å·²çŸ¥å’ŒæœªçŸ¥çš„æ¶æ„è½¯ä»¶å’Œå¨èƒï¼Œå¹¶æä¾›å…å—æ­¤ç±»å¨èƒçš„ä¿æŠ¤ï¼›æ­¤å¤–ï¼Œå®ƒä»¬è¿˜æä¾›è°ƒæŸ¥å’Œè¡¥æ•‘ä»»ä½•é€ƒé¿ä¿æŠ¤æ§åˆ¶çš„äº‹ä»¶çš„èƒ½åŠ›ã€‚\r\n- EPPçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ï¼š\r\n  - é¢„é˜²å’Œä¿æŠ¤å®‰å…¨å¨èƒï¼ŒåŒ…æ‹¬ä½¿ç”¨åŸºäºæ–‡ä»¶å’Œæ— æ–‡ä»¶æ¼æ´çš„æ¶æ„è½¯ä»¶ã€‚\r\n  - å°†æ§åˆ¶ï¼ˆå…è®¸/é˜»æ­¢ï¼‰åº”ç”¨äºè½¯ä»¶ã€è„šæœ¬å’Œè¿›ç¨‹çš„èƒ½åŠ› ã€‚\r\n  - ä½¿ç”¨å¯¹è®¾å¤‡æ´»åŠ¨ã€åº”ç”¨ç¨‹åºå’Œç”¨æˆ·æ•°æ®çš„è¡Œä¸ºåˆ†ææ¥æ£€æµ‹å’Œé¢„é˜²å¨èƒçš„èƒ½åŠ› ã€‚\r\n  - å½“æ¼æ´åˆ©ç”¨é€ƒé¿ä¿æŠ¤æ§åˆ¶æ—¶è¿›ä¸€æ­¥è°ƒæŸ¥äº‹ä»¶å’Œ/æˆ–è·å¾—è¡¥æ•‘æŒ‡å¯¼çš„è®¾æ–½ ã€‚\r\n- EPPä¸­ç»å¸¸å‡ºç°çš„å¯é€‰åŠŸèƒ½å¯èƒ½åŒ…æ‹¬ï¼š\r\n  - ç»ˆç«¯è®¾å¤‡çš„èµ„äº§ã€é…ç½®å’Œç­–ç•¥ç®¡ç†çš„æ”¶é›†å’ŒæŠ¥å‘Š ã€‚\r\n  - ç£ç›˜åŠ å¯†ã€æœ¬åœ°é˜²ç«å¢™è®¾ç½®ç­‰æ“ä½œç³»ç»Ÿå®‰å…¨æ§åˆ¶çŠ¶æ€çš„ç®¡ç†å’ŒæŠ¥å‘Š ã€‚\r\n  - æ‰«æç³»ç»Ÿæ¼æ´å’ŒæŠ¥å‘Š/ç®¡ç†å®‰å…¨è¡¥ä¸å®‰è£…çš„è®¾æ–½ ã€‚\r\n  - èƒ½å¤ŸæŠ¥å‘Šäº’è”ç½‘ã€ç½‘ç»œå’Œåº”ç”¨ç¨‹åºæ´»åŠ¨ï¼Œä»¥è·å¾—æ½œåœ¨æ¶æ„æ´»åŠ¨çš„å…¶ä»–è¿¹è±¡ ã€‚\r\n\r\n# 3. å¸‚åœºæ¦‚è§ˆ\r\n- å‹’ç´¢è½¯ä»¶ç›®å‰æ˜¯æ‰€æœ‰ç»„ç»‡é¢ä¸´çš„æœ€å¤§é£é™©ã€‚\r\n- è¿œç¨‹åŠå…¬æ˜¾è‘—åŠ é€Ÿäº†åŸºäºäº‘çš„è§£å†³æ–¹æ¡ˆè½åœ°ï¼ˆå­˜é‡å 60%ï¼Œå¢é‡å 95%ï¼‰ã€‚\r\n- æ— æ–‡ä»¶æ”»å‡»å·²ç»éå¸¸æ™®åŠï¼Œä½¿å¾—åŸºäºè¡Œä¸ºçš„æ£€æµ‹é˜²æŠ¤æˆä¸ºEDRå·¥å…·çš„å…³é”®èƒ½åŠ›ã€‚\r\n- é‡‡ç”¨EDRå·¥å…·çš„æœ€å¤§éšœç¢ä»ç„¶æ˜¯æ“ä½œå®ƒä»¬æ‰€éœ€çš„æŠ€èƒ½å’Œå¢åŠ çš„æ€»æˆæœ¬ã€‚\r\n- ä¸ºäº†ç¼©å°æŠ€èƒ½å·®è·ï¼Œæä¾›ç›‘æ§å’Œè­¦æŠ¥åˆ†ç±»çš„MDRæœåŠ¡æ­£å˜å¾—è¶Šæ¥è¶Šæµè¡Œã€‚\r\n- SolarWindsä¾›åº”é“¾æ”»å‡»è¯´æ˜äº†EDRçš„ä»·å€¼å’Œç¼ºç‚¹ï¼›EDRå¹¶æ²¡æœ‰å®æ—¶æ£€æµ‹åˆ°SolarWindsæ”»å‡»ï¼Œä½†åœ¨é˜»æ­¢æ–°å‘ç°çš„æ¶æ„è¡Œä¸ºéå¸¸æœ‰ç”¨ã€‚\r\n- SolarWinds æ”»å‡»è¿˜è¡¨æ˜éœ€è¦è‡³å°‘æ›´å¥½åœ°é›†æˆæ¥è‡ªèº«ä»½å’Œç”µå­é‚®ä»¶çš„é¥æµ‹æ•°æ®ï¼Œä»¥åŠéœ€è¦æœ‰æ•ˆçš„ç¯¡æ”¹ä¿æŠ¤ä»¥ç¡®ä¿ä»£ç†ä¸è¢«ç¦ç”¨ã€‚\r\n- XDRæ­£åœ¨æˆä¸ºEPPè§£å†³æ–¹æ¡ˆçš„æœ€æ–°å…³é”®åŠŸèƒ½ã€‚\r\n- æ‰€æœ‰ç»„ç»‡éƒ½éœ€è¦ä¼˜å…ˆçº§æ›´é«˜çš„åŠ å›ºæŒ‡å¯¼ã€‚\r\n- EPPè§£å†³æ–¹æ¡ˆè¿˜å¯ä»¥æ·»åŠ ç§»åŠ¨ç«¯çš„å¨èƒé˜²å¾¡å’Œä¸ç»Ÿä¸€ç»ˆç«¯ç®¡ç†çš„é›†æˆï¼Œä»¥å‡å°‘æ•´ä½“ç®¡ç†è´Ÿæ‹…ã€‚\r\n\r\n# 4. å‡†å…¥å‡†å‡ºåŸåˆ™\r\n- æ‰€æœ‰ä¾›åº”å•†å¿…é¡»è‡³å°‘æä¾›ä»¥ä¸‹12é¡¹ï¼š\r\n  - æ— éœ€æ›´æ–°è§„åˆ™å³å¯é˜²å¾¡ã€‚\r\n  - å¯ä»¥æ ¹æ®è¿›ç¨‹è¡Œä¸ºæ£€æµ‹æ¶æ„æ´»åŠ¨ã€‚\r\n  - å¯ä»¥å°†IOC/IOAæ•°æ®é›†ä¸­å­˜å‚¨åˆ†æã€‚\r\n  - èƒ½å¤Ÿæ£€æµ‹é˜²å¾¡æ— æ–‡ä»¶æ¶æ„æ–‡ä»¶çš„æ”»å‡»ã€‚\r\n  - æ£€æµ‹åˆ°æ¶æ„è½¯ä»¶æ—¶è‡ªåŠ¨åˆ é™¤æ¶æ„è½¯ä»¶ï¼Œåˆ é™¤/éš”ç¦»æ–‡ä»¶/ç»ˆæ­¢è¿›ç¨‹ã€‚\r\n  - èƒ½å¤Ÿåœ¨æ§åˆ¶å°å‹åˆ¶/å¿½ç•¥è¯¯æŠ¥ã€‚\r\n  - EPPæ§åˆ¶å°å¿…é¡»æ˜¯åŸºäºäº‘çš„SaaSæœåŠ¡ï¼Œç”±ä¾›åº”å•†ç®¡ç†ç»´æŠ¤ã€‚\r\n  - æ§åˆ¶å°å’ŒæŠ¥å‘Šèƒ½å¤Ÿæ˜¾ç¤ºå®Œæ•´çš„è¿›ç¨‹æ ‘ï¼Œä»¥è¯†åˆ«è¿›ç¨‹æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Œå¹¶è¿›è¡Œå¯æ“ä½œçš„æ ¹æœ¬åŸå› åˆ†æã€‚\r\n  - éœ€æä¾›å¨èƒç‹©çŒèƒ½åŠ›ï¼Œæ§åˆ¶å°æä¾›è·¨ç»ˆç«¯çš„IOC/IOAï¼ˆå¦‚æ–‡ä»¶å“ˆå¸Œã€æº/ç›®æ ‡ IPã€æ³¨å†Œè¡¨é¡¹ï¼‰æœç´¢ã€‚\r\n  - èƒ½å¤Ÿè¯†åˆ«æ¶æ„è½¯ä»¶å¹¶ç»™å‡ºä¿®å¤æ­¥éª¤æˆ–è€…å®ç°å›æ»šã€‚\r\n  - æä¾›é€‰é¡¹å°†å¨èƒæƒ…æŠ¥é›†æˆåˆ°ç®¡ç†æ§åˆ¶å°ä¸­ã€‚\r\n  - èƒ½å¤Ÿé˜²æŠ¤å¸¸è§åº”ç”¨ç¨‹åºæ¼æ´å’Œå†…å­˜åˆ©ç”¨æ”»å‡»ã€‚\r\n  - å½“ç»ˆç«¯è®¾å¤‡ä½äºå…¬å¸ç½‘ç»œä¹‹å¤–æ—¶ï¼Œå¿…é¡»ç»§ç»­æ”¶é›†å¯ç–‘äº‹ä»¶æ•°æ®ã€‚\r\n  - èƒ½å¯¹æ–‡ä»¶å¤¹ã€é©±åŠ¨å™¨æˆ–è®¾å¤‡ï¼ˆä¾‹å¦‚ USB é©±åŠ¨å™¨ï¼‰æ‰§è¡Œé™æ€ã€æŒ‰éœ€æ¶æ„è½¯ä»¶æ£€æµ‹æ‰«æã€‚\r\n  - æ‰€æœ‰åŠŸèƒ½éƒ½å¿…é¡»åœ¨å•ä¸ªagent/sensorä¸­æä¾›æˆ–ç›´æ¥é›†æˆåˆ°æ“ä½œç³»ç»Ÿä¸­ã€‚\r\n\r\n# 5. å‚è€ƒèµ„æ–™\r\n- [https://www.gartner.com/doc/reprints?ct=210506&id=1-25Z4TEJM&st=sb](https://www.gartner.com/doc/reprints?ct=210506&id=1-25Z4TEJM&st=sb)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue TeamåŸºç¡€è®¾æ–½/ç»ˆç«¯åŸºç¡€è®¾æ–½/EDR/ä¿éšœIDCå®‰å…¨ï¼šåˆ†å¸ƒå¼HIDSé›†ç¾¤æ¶æ„è®¾è®¡/","title":"ä¿éšœIDCå®‰å…¨ï¼šåˆ†å¸ƒå¼HIDSé›†ç¾¤æ¶æ„è®¾è®¡"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: ä¿éšœIDCå®‰å…¨ï¼šåˆ†å¸ƒå¼HIDSé›†ç¾¤æ¶æ„è®¾è®¡\r\ntags:\r\n- Blue TeamåŸºç¡€è®¾æ–½\r\n- ç»ˆç«¯åŸºç¡€è®¾æ–½\r\n- EDR\r\n---\r\n\r\n# 1. è½¬è½½è‡ªç¾å›¢æŠ€æœ¯å›¢é˜Ÿ\r\n- [https://tech.meituan.com/2019/01/17/distributed-hids-cluster-architecture-design.html](https://tech.meituan.com/2019/01/17/distributed-hids-cluster-architecture-design.html)\r\n\r\n# 2. èƒŒæ™¯\r\nè¿‘å¹´æ¥ï¼Œäº’è”ç½‘ä¸Šå®‰å…¨äº‹ä»¶é¢‘å‘ï¼Œä¼ä¸šä¿¡æ¯å®‰å…¨è¶Šæ¥è¶Šå—åˆ°é‡è§†ï¼Œè€ŒIDCæœåŠ¡å™¨å®‰å…¨åˆæ˜¯çºµæ·±é˜²å¾¡ä½“ç³»ä¸­çš„é‡è¦ä¸€ç¯ã€‚ä¿éšœIDCå®‰å…¨ï¼Œå¸¸ç”¨çš„æ˜¯åŸºäºä¸»æœºå‹å…¥ä¾µæ£€æµ‹ç³»ç»ŸHost-based Intrusion Detection Systemï¼Œå³HIDSã€‚åœ¨HIDSé¢å¯¹å‡ åä¸‡å°ç”šè‡³ä¸Šç™¾ä¸‡å°è§„æ¨¡çš„IDCç¯å¢ƒæ—¶ï¼Œç³»ç»Ÿæ¶æ„è¯¥å¦‚ä½•è®¾è®¡å‘¢ï¼Ÿå¤æ‚çš„æœåŠ¡å™¨ç¯å¢ƒï¼Œç½‘ç»œç¯å¢ƒï¼Œå·¨å¤§çš„æ•°æ®é‡ç»™æˆ‘ä»¬å¸¦æ¥äº†å“ªäº›æŠ€æœ¯æŒ‘æˆ˜å‘¢ï¼Ÿ\r\n\r\n# 3. éœ€æ±‚æè¿°\r\nå¯¹äºHIDSäº§å“ï¼Œæˆ‘ä»¬å®‰å…¨éƒ¨é—¨çš„äº§å“ç»ç†æå‡ºäº†ä»¥ä¸‹éœ€æ±‚ï¼š\r\n\r\n- æ»¡è¶³50W-100WæœåŠ¡å™¨é‡çº§çš„IDCè§„æ¨¡ã€‚\r\n- éƒ¨ç½²åœ¨é«˜å¹¶å‘æœåŠ¡å™¨ç”Ÿäº§ç¯å¢ƒï¼Œè¦æ±‚Agentä½æ€§èƒ½ä½æŸè€—ã€‚\r\n- å¹¿æ³›çš„éƒ¨ç½²å…¼å®¹æ€§ã€‚\r\n- åå‘åº”ç”¨å±‚å’Œç”¨æˆ·æ€å…¥ä¾µæ£€æµ‹ï¼ˆå¯ä»¥å’Œå†…æ ¸æ€æ£€æµ‹éƒ¨åˆ†è§£è€¦ï¼‰ã€‚\r\n- é’ˆå¯¹åˆ©ç”¨ä¸»æœºAgentæ’æŸ¥æ¼æ´çš„æœ€æ€¥éœ€åœºæ™¯æä¾›åŸºæœ¬çš„èƒ½åŠ›ï¼Œå¯ä»¥å®ç°æµ·é‡ç¯å¢ƒä¸‹å¿«é€ŸæŸ¥æ‰¾ç³»ç»Ÿæ¼æ´ã€‚\r\n- Agentè·ŸServerçš„é…ç½®ä¸‹å‘é€šé“å®‰å…¨ã€‚\r\n- é…ç½®ä¿¡æ¯è¯»å–å†™å…¥éœ€è¦é‰´æƒã€‚\r\n- é…ç½®å˜æ›´å†å²è®°å½•ã€‚\r\n- Agentæ’ä»¶å…·å¤‡è‡ªæ›´æ–°åŠŸèƒ½ã€‚\r\n\r\n# 4. åˆ†æéœ€æ±‚\r\n  - é¦–å…ˆï¼ŒæœåŠ¡å™¨ä¸šåŠ¡è¿›ç¨‹ä¼˜å…ˆçº§é«˜ï¼ŒHIDS Agentè¿›ç¨‹è‡ªå·±å¯ä»¥ç»ˆæ­¢ï¼Œä½†ä¸èƒ½å½±å“å®¿ä¸»æœºçš„ä¸»è¦ä¸šåŠ¡ï¼Œè¿™æ˜¯ç¬¬ä¸€è¦ç‚¹ï¼Œé‚£ä¹ˆä¸šåŠ¡éœ€è¦å…·å¤‡ç†”æ–­åŠŸèƒ½ï¼Œå¹¶å…·å¤‡è‡ªæˆ‘æ¢å¤èƒ½åŠ›ã€‚\r\n  - å…¶æ¬¡ï¼Œè¿›ç¨‹ä¿æ´»ã€ç»´æŒå¿ƒè·³ã€å®æ—¶è·å–æ–°æŒ‡ä»¤èƒ½åŠ›ï¼Œç™¾ä¸‡å°Agentçš„å…¨é‡æ§åˆ¶æ—¶é—´ä¸€å®šè¦çŸ­ã€‚ä¸¾ä¸ªæç«¯çš„ä¾‹å­ï¼Œå½“Agentå‡ºç°ç´§æ€¥æƒ…å†µï¼Œéœ€è¦å…¨é‡åœæ­¢æ—¶ï¼Œé‚£ä¹ˆå…¨é‡åœæ­¢çš„å‘½ä»¤ä¸‹å‘ï¼Œéœ€è¦åœ¨1-2åˆ†é’Ÿå†…å®Œæˆï¼Œç”šè‡³30ç§’ã€20ç§’å†…å®Œæˆã€‚è¿™äº›å°†ä¼šæ˜¯å¾ˆå¤§çš„æŠ€æœ¯æŒ‘æˆ˜ã€‚\r\n  - è¿˜æœ‰å¯¹é…ç½®åŠ¨æ€æ›´æ–°ï¼Œæ—¥å¿—çº§åˆ«æ§åˆ¶ï¼Œç»†åˆ†ç²¾ç¡®æ§åˆ¶åˆ°æ¯ä¸ªAgentä¸Šçš„æ¯ä¸ªHIDSå­è¿›ç¨‹ï¼Œèƒ½è‡ªç”±åœ°æ§åˆ¶æ¯ä¸ªè¿›ç¨‹çš„å¯åœï¼Œæ¯ä¸ªAgentçš„å‚æ•°ï¼Œä¹Ÿèƒ½ç²¾ç¡®çš„æ„ŸçŸ¥æ¯å°Agentçš„ä¸Šçº¿ã€ä¸‹çº¿æƒ…å†µã€‚\r\n  - åŒæ—¶ï¼ŒAgentæœ¬èº«æ˜¯å®‰å…¨Agentï¼Œå®‰å…¨çš„å› ç´ ä¹Ÿè¦è€ƒè™‘è¿›å»ï¼ŒåŒ…æ‹¬é€šä¿¡é€šé“çš„å®‰å…¨æ€§ï¼Œé…ç½®ç®¡ç†çš„å®‰å…¨æ€§ç­‰ç­‰ã€‚\r\n  - æœ€åï¼ŒæœåŠ¡ç«¯ä¹Ÿè¦æœ‰ä¸€è‡´æ€§ä¿éšœã€å¯ç”¨æ€§ä¿éšœï¼Œå¯¹äºå¤§é‡Agentçš„ç®¡ç†ï¼Œå¿…é¡»èƒ½å®ç°ä»»åŠ¡åˆ†æ‘Šï¼Œå¹¶è¡Œå¤„ç†ä»»åŠ¡ï¼Œä¸”ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚è€ƒè™‘åˆ°å…¬å¸è§„æ¨¡ä¸æ–­åœ°æ‰©å¤§ï¼Œä¸šåŠ¡ä¸æ–­åœ°å¢å¤šï¼Œç‰¹åˆ«æ˜¯ç¾å›¢å’Œå¤§ä¼—ç‚¹è¯„åˆå¹¶åï¼Œé¢å¯¹çš„å„ç§æ“ä½œç³»ç»Ÿé—®é¢˜ï¼Œäº§å“è¿˜è¦å…·å¤‡è‰¯å¥½çš„å…¼å®¹æ€§ã€å¯ç»´æŠ¤æ€§ç­‰ã€‚\r\n  - æ€»ç»“ä¸‹æ¥ï¼Œäº§å“æ¶æ„è¦ç¬¦åˆä»¥ä¸‹ç‰¹æ€§ï¼š\r\n    - é›†ç¾¤é«˜å¯ç”¨ã€‚\r\n    - åˆ†å¸ƒå¼ï¼Œå»ä¸­å¿ƒåŒ–ã€‚\r\n    - é…ç½®ä¸€è‡´æ€§ï¼Œé…ç½®å¤šç‰ˆæœ¬å¯è¿½æº¯ã€‚\r\n    - åˆ†æ²»ä¸æ±‡æ€»ã€‚\r\n    - å…¼å®¹éƒ¨ç½²å„ç§Linux æœåŠ¡å™¨ï¼Œåªç»´æŠ¤ä¸€ä¸ªç‰ˆæœ¬ã€‚\r\n    - èŠ‚çœèµ„æºï¼Œå ç”¨è¾ƒå°‘çš„CPUã€å†…å­˜ã€‚\r\n    - ç²¾ç¡®çš„ç†”æ–­é™æµã€‚\r\n    - æœåŠ¡å™¨æ•°é‡è§„æ¨¡è¾¾åˆ°ç™¾ä¸‡çº§çš„é›†ç¾¤è´Ÿè½½èƒ½åŠ›ã€‚\r\n\r\n# 5. æŠ€æœ¯éš¾ç‚¹ï¼š\r\nåœ¨åˆ—å‡ºäº§å“éœ€è¦å®ç°çš„åŠŸèƒ½ç‚¹ã€æŠ€æœ¯ç‚¹åï¼Œå†æ¥åˆ†æä¸‹é‡åˆ°çš„æŠ€æœ¯æŒ‘æˆ˜ï¼ŒåŒ…æ‹¬ä¸é™äºä»¥ä¸‹å‡ ç‚¹ï¼š\r\n\r\n- èµ„æºé™åˆ¶ï¼Œè¾ƒå°çš„CPUã€å†…å­˜ã€‚\r\n- äº”åä¸‡ç”šè‡³ä¸€ç™¾ä¸‡å°æœåŠ¡å™¨çš„Agentå¤„ç†æ§åˆ¶é—®é¢˜ã€‚\r\n- é‡çº§å¤§äº†åï¼Œé›†ç¾¤æ§åˆ¶å¸¦æ¥çš„æ§åˆ¶æ•ˆç‡ï¼Œå“åº”å»¶è¿Ÿï¼Œæ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚\r\n- é‡çº§å¤§äº†åï¼Œæ•°æ®ä¼ è¾“å¯¹æ•´ä¸ªæœåŠ¡å™¨å†…ç½‘å¸¦æ¥çš„æµé‡å†²å‡»é—®é¢˜ã€‚\r\n- é‡çº§å¤§äº†åï¼Œè¿è¡Œç¯å¢ƒæ›´å¤æ‚ï¼ŒAgentå¼‚å¸¸è¡¨ç°çš„æ„ŸçŸ¥é—®é¢˜ã€‚\r\n- é‡çº§å¤§äº†åï¼Œä¸šåŠ¡æ—¥å¿—ã€ç¨‹åºè¿è¡Œæ—¥å¿—çš„ä¼ è¾“ã€å­˜å‚¨é—®é¢˜ï¼Œè¢«ç›‘æ§ä¸šåŠ¡è®¿é—®é‡çªå¢å¸¦æ¥ç›‘æ§æ•°æ®è”çªå¢ï¼Œå¯¹å†…ç½‘å¸¦å®½ï¼Œå­˜å‚¨é›†ç¾¤çš„çˆ†å‘å‹åŠ›é—®é¢˜ã€‚\r\n\r\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒæŠ€æœ¯éš¾ç‚¹å‡ ä¹éƒ½æ˜¯æœåŠ¡å™¨åˆ°è¾¾ä¸€å®šé‡çº§å¸¦æ¥çš„ï¼Œå¯¹äºå¤§é‡çš„æœåŠ¡ï¼Œé›†ç¾¤åˆ†å¸ƒå¼æ˜¯ä¸šç•Œå¸¸è§çš„è§£å†³æ–¹æ¡ˆã€‚\r\n\r\n# 6. æ¶æ„è®¾è®¡ä¸æŠ€æœ¯é€‰å‹\r\nå¯¹äºç®¡ç†Agentçš„æœåŠ¡ç«¯æ¥è¯´ï¼Œè¦å®ç°é«˜å¯ç”¨ã€å®¹ç¾è®¾è®¡ï¼Œé‚£ä¹ˆä¸€å®šè¦åšå¤šæœºæˆ¿éƒ¨ç½²ï¼Œå°±ä¸€å®šä¼šé‡åˆ°æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚é‚£ä¹ˆæ•°æ®çš„å­˜å‚¨ï¼Œå°±è¦è€ƒè™‘åˆ†å¸ƒå¼å­˜å‚¨ç»„ä»¶ã€‚ åˆ†å¸ƒå¼æ•°æ®å­˜å‚¨ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªå®šç†å«`CAPå®šç†`ï¼š\r\n\r\n![lxjgAk](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/lxjgAk.jpg)\r\n\r\n**CAPçš„è§£é‡Š**:\r\n- å…³äº`CAPå®šç†`ï¼Œåˆ†ä¸ºä»¥ä¸‹ä¸‰ç‚¹ï¼š\r\n  - ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šåˆ†å¸ƒå¼æ•°æ®åº“çš„æ•°æ®ä¿æŒä¸€è‡´ã€‚\r\n  - å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ï¼šä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œå…¶ä»–èŠ‚ç‚¹å¯ä»¥ç»§ç»­å¯¹å¤–æä¾›æœåŠ¡ã€‚\r\n  - åˆ†åŒºå®¹é”™æ€§ï¼ˆç½‘ç»œåˆ†åŒºï¼‰Partition Toleranceï¼šä¸€ä¸ªæ•°æ®åº“æ‰€åœ¨çš„æœºå™¨åäº†ï¼Œå¦‚ç¡¬ç›˜åäº†ï¼Œæ•°æ®ä¸¢å¤±äº†ï¼Œå¯ä»¥æ·»åŠ ä¸€å°æœºå™¨ï¼Œç„¶åä»å…¶ä»–æ­£å¸¸çš„æœºå™¨æŠŠå¤‡ä»½çš„æ•°æ®åŒæ­¥è¿‡æ¥ã€‚\r\n- æ ¹æ®å®šç†ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿåªèƒ½æ»¡è¶³ä¸‰é¡¹ä¸­çš„ä¸¤é¡¹è€Œä¸å¯èƒ½æ»¡è¶³å…¨éƒ¨ä¸‰é¡¹ã€‚ç†è§£CAPå®šç†çš„æœ€ç®€å•æ–¹å¼æ˜¯æƒ³è±¡ä¸¤ä¸ªèŠ‚ç‚¹åˆ†å¤„åˆ†åŒºä¸¤ä¾§ã€‚å…è®¸è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹æ›´æ–°çŠ¶æ€ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼Œå³ä¸§å¤±äº†Consistencyã€‚å¦‚æœä¸ºäº†ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œå°†åˆ†åŒºä¸€ä¾§çš„èŠ‚ç‚¹è®¾ç½®ä¸ºä¸å¯ç”¨ï¼Œé‚£ä¹ˆåˆä¸§å¤±äº†Availabilityã€‚é™¤éä¸¤ä¸ªèŠ‚ç‚¹å¯ä»¥äº’ç›¸é€šä¿¡ï¼Œæ‰èƒ½æ—¢ä¿è¯Consistencyåˆä¿è¯Availabilityï¼Œè¿™åˆä¼šå¯¼è‡´ä¸§å¤±Partition Toleranceã€‚\r\n- å‚è§ï¼š[CAP Theorem](https://en.wikipedia.org/wiki/CAP_theorem)\r\n\r\n**CAPçš„é€‰æ‹©**:\r\n- ä¸ºäº†å®¹ç¾ä¸Šè®¾è®¡ï¼Œé›†ç¾¤èŠ‚ç‚¹çš„éƒ¨ç½²ï¼Œä¼šé€‰æ‹©çš„å¼‚åœ°å¤šæœºæˆ¿ï¼Œæ‰€ä»¥ ã€ŒPartition toleranceã€æ˜¯ä¸å¯èƒ½é¿å…çš„ã€‚é‚£ä¹ˆå¯é€‰çš„æ˜¯ `AP` ä¸ `CP`ã€‚\r\n- åœ¨HIDSé›†ç¾¤çš„åœºæ™¯é‡Œï¼Œå„ä¸ªAgentå¯¹é›†ç¾¤æŒç»­å¯ç”¨æ€§æ²¡æœ‰éå¸¸å¼ºçš„è¦æ±‚ï¼Œåœ¨çŸ­æš‚æ—¶é—´å†…ï¼Œæ˜¯å¯ä»¥å‡ºç°å¼‚å¸¸ï¼Œå‡ºç°æ— æ³•é€šè®¯çš„æƒ…å†µã€‚ä½†æœ€ç»ˆçŠ¶æ€å¿…é¡»è¦ä¸€è‡´ï¼Œä¸èƒ½å­˜åœ¨é›†ç¾¤ä¸‹å‘å…³åœæŒ‡ä»¤ï¼Œè€Œå‡ºç°ä¸ªåˆ«Agentä¸å¬ä»é›†ç¾¤æ§åˆ¶çš„æƒ…å†µå‡ºç°ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ»¡è¶³ `CP` çš„äº§å“ã€‚\r\n\r\n# 7. æ»¡è¶³CPçš„äº§å“é€‰æ‹©\r\n  - åœ¨å¼€æºç¤¾åŒºä¸­ï¼Œæ¯”è¾ƒå‡ºåçš„å‡ æ¬¾æ»¡è¶³CPçš„äº§å“ï¼Œæ¯”å¦‚etcdã€ZooKeeperã€Consulç­‰ã€‚æˆ‘ä»¬éœ€è¦æ ¹æ®å‡ æ¬¾äº§å“çš„ç‰¹ç‚¹ï¼Œæ ¹æ®æˆ‘ä»¬éœ€æ±‚æ¥é€‰æ‹©ç¬¦åˆæˆ‘ä»¬éœ€æ±‚çš„äº§å“ã€‚\r\n  - æ’ä¸€å¥ï¼Œç½‘ä¸Šå¾ˆå¤šäººè¯´Consulæ˜¯APäº§å“ï¼Œè¿™æ˜¯ä¸ªé”™è¯¯çš„æè¿°ã€‚æ—¢ç„¶Consulæ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²ï¼Œé‚£ä¹ˆä¸€å®šä¼šå‡ºç°ã€Œç½‘ç»œåˆ†åŒºã€çš„é—®é¢˜ï¼Œ é‚£ä¹ˆä¸€å®šè¦æ”¯æŒã€ŒPartition toleranceã€ã€‚å¦å¤–ï¼Œåœ¨consulçš„å®˜ç½‘ä¸Šè‡ªå·±ä¹Ÿæåˆ°äº†è¿™ç‚¹ Consul uses a CP architecture, favoring consistency over availability.\r\n  \r\n    > Consul is opinionated in its usage while Serf is a more flexible and general purpose tool. In CAP terms, Consul uses a CP architecture, favoring consistency over availability. Serf is an AP system and sacrifices consistency for availability. This means Consul cannot operate if the central servers cannot form a quorum while Serf will continue to function under almost all circumstances.\r\n\r\n  - **etcdã€ZooKeeperã€Consulå¯¹æ¯”**\r\n\r\n    - å€Ÿç”¨etcdå®˜ç½‘ä¸Šetcdä¸ZooKeeperå’ŒConsulçš„æ¯”è¾ƒå›¾ã€‚\r\n    - ![XotcyC](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/XotcyC.jpg)\r\n    - åœ¨æˆ‘ä»¬HIDS Agentçš„éœ€æ±‚ä¸­ï¼Œé™¤äº†åŸºæœ¬çš„`æœåŠ¡å‘ç°` ã€`é…ç½®åŒæ­¥` ã€`é…ç½®å¤šç‰ˆæœ¬æ§åˆ¶` ã€`å˜æ›´é€šçŸ¥`ç­‰åŸºæœ¬éœ€æ±‚å¤–ï¼Œæˆ‘ä»¬è¿˜æœ‰åŸºäºäº§å“å®‰å…¨æ€§ä¸Šçš„è€ƒè™‘ï¼Œæ¯”å¦‚`ä¼ è¾“é€šé“åŠ å¯†`ã€`ç”¨æˆ·æƒé™æ§åˆ¶`ã€`è§’è‰²ç®¡ç†`ã€`åŸºäºKeyçš„æƒé™è®¾å®š`ç­‰ï¼Œè¿™ç‚¹ `etcd` æ¯”è¾ƒç¬¦åˆæˆ‘ä»¬è¦æ±‚ã€‚å¾ˆå¤šå¤§å‹å…¬å¸éƒ½åœ¨ä½¿ç”¨ï¼Œæ¯”å¦‚`Kubernetes`ã€`AWS`ã€`OpenStack`ã€`Azure`ã€`Google Cloud`ã€`Huawei Cloud`ç­‰ï¼Œå¹¶ä¸”`etcd`çš„ç¤¾åŒºæ”¯æŒéå¸¸å¥½ã€‚åŸºäºè¿™å‡ ç‚¹å› ç´ ï¼Œæˆ‘ä»¬é€‰æ‹©etcdä½œä¸ºHIDSçš„åˆ†å¸ƒå¼é›†ç¾¤ç®¡ç†ã€‚\r\n\r\n# 8. åˆ†å¸ƒå¼HIDSé›†ç¾¤æ¶æ„å›¾\r\n![c09vZx](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/c09vZx.jpg)\r\n\r\n# 9. ç¼–ç¨‹è¯­è¨€é€‰æ‹©\r\nè€ƒè™‘åˆ°å…¬å¸æœåŠ¡å™¨é‡å¤§ï¼Œä¸šåŠ¡å¤æ‚ï¼Œéœ€æ±‚ç¯å¢ƒå¤šå˜ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½åŒ…æ‹¬å„ç§Linuxä»¥åŠWindowsç­‰ã€‚ä¸ºäº†ä¿è¯ç³»ç»Ÿçš„å…¼å®¹æ€§ï¼Œæˆ‘ä»¬é€‰æ‹©äº†Golangä½œä¸ºå¼€å‘è¯­è¨€ï¼Œå®ƒå…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹ï¼š\r\n\r\n- å¯ä»¥é™æ€ç¼–è¯‘ï¼Œç›´æ¥é€šè¿‡syscallæ¥è¿è¡Œï¼Œä¸ä¾èµ–libcï¼Œå…¼å®¹æ€§é«˜ï¼Œå¯ä»¥åœ¨æ‰€æœ‰Linuxä¸Šæ‰§è¡Œï¼Œéƒ¨ç½²ä¾¿æ·ã€‚\r\n- é™æ€ç¼–è¯‘è¯­è¨€ï¼Œèƒ½å°†ç®€å•çš„é”™è¯¯åœ¨ç¼–è¯‘å‰å°±å‘ç°ã€‚\r\n- å…·å¤‡è‰¯å¥½çš„GCæœºåˆ¶ï¼Œå ç”¨ç³»ç»Ÿèµ„æºå°‘ï¼Œå¼€å‘æˆæœ¬ä½ã€‚\r\n- å®¹å™¨åŒ–çš„å¾ˆå¤šäº§å“éƒ½æ˜¯Golangç¼–å†™ï¼Œæ¯”å¦‚Kubernetesã€Dockerç­‰ã€‚\r\n- etcdé¡¹ç›®ä¹Ÿæ˜¯Golangç¼–å†™ï¼Œç±»åº“ã€æµ‹è¯•ç”¨ä¾‹å¯ä»¥ç›´æ¥ç”¨ï¼ŒSDKæ”¯æŒå¿«é€Ÿã€‚\r\n- è‰¯å¥½çš„CSPå¹¶å‘æ¨¡å‹æ”¯æŒï¼Œé«˜æ•ˆçš„åç¨‹è°ƒåº¦æœºåˆ¶ã€‚\r\n\r\n# 10. äº§å“æ¶æ„å¤§æ–¹å‘\r\n  - HIDSäº§å“ç ”å‘å®Œæˆåï¼Œéƒ¨ç½²çš„æœåŠ¡éƒ½è¿è¡Œç€å„ç§ä¸šåŠ¡çš„æœåŠ¡å™¨ï¼Œä¸šåŠ¡çš„é‡è¦æ€§æ’åœ¨ç¬¬ä¸€ï¼Œæˆ‘ä»¬äº§å“çš„åŠŸèƒ½æ’åœ¨åé¢ã€‚ä¸ºæ­¤ï¼Œç¡®å®šäº†å‡ ä¸ªäº§å“çš„å¤§æ–¹å‘ï¼š\r\n    - é«˜å¯ç”¨ï¼Œæ•°æ®ä¸€è‡´ï¼Œå¯æ¨ªå‘æ‰©å±•ã€‚\r\n    - å®¹ç¾æ€§å¥½ï¼Œèƒ½åº”å¯¹æœºæˆ¿çº§çš„ç½‘ç»œæ•…éšœã€‚\r\n    - å…¼å®¹æ€§å¥½ï¼Œåªç»´æŠ¤ä¸€ä¸ªç‰ˆæœ¬çš„Agentã€‚\r\n    - ä¾èµ–ä½ï¼Œä¸ä¾èµ–ä»»ä½•åŠ¨æ€é“¾æ¥åº“ã€‚\r\n    - ä¾µå…¥æ€§ä½ï¼Œä¸åšHookï¼Œä¸åšç³»ç»Ÿç±»åº“æ›´æ”¹ã€‚\r\n    - ç†”æ–­é™çº§å¯é ï¼Œå®å¯è‡ªå·±æŒ‚æ‰ï¼Œä¹Ÿä¸å½±å“ä¸šåŠ¡ ã€‚\r\n\r\n# 11. æ¡†æ¶è®¾è®¡\r\n![XMnpix](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/XMnpix.jpg)\r\n\r\nå¦‚ä¸Šå›¾ï¼Œåœ¨æ¡†æ¶çš„è®¾è®¡ä¸Šï¼Œå°è£…å¸¸ç”¨ç±»åº“ï¼ŒæŠ½è±¡åŒ–å®šä¹‰`Interface`ï¼Œå‰¥ç¦»`etcd Client`ï¼Œå…¨å±€åŒ–`Logger`ï¼ŒæŠ½è±¡åŒ–Appçš„å¯åŠ¨ã€é€€å‡ºæ–¹æ³•ã€‚ä½¿å¾—å„`æ¨¡å—`ï¼ˆä»¥ä¸‹ç®€ç§°`App`ï¼‰åªéœ€è¦å®ç°è‡ªå·±çš„ä¸šåŠ¡å³å¯ï¼Œå¯ä»¥æ–¹ä¾¿å¿«æ·çš„è¿›è¡Œé€»è¾‘ç¼–å†™ï¼Œæ— éœ€å…³å¿ƒåº•å±‚å®ç°ã€é…ç½®æ¥æºã€é‡è¯•æ¬¡æ•°ã€ç†”æ–­æ–¹æ¡ˆç­‰ç­‰ã€‚\r\n\r\nåé¢ä¸å†copyï¼Œæ„Ÿå…´è¶£è¯·å‚è€ƒåŸæ–‡"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue TeamåŸºç¡€è®¾æ–½/ç»ˆç«¯åŸºç¡€è®¾æ–½/EDRèƒ½åŠ›è¯„ä¼°/MITRE EDRæŠ€æœ¯èƒ½åŠ›è¯„ä¼°/","title":"MITRE EDRæŠ€æœ¯èƒ½åŠ›è¯„ä¼°"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: MITRE EDRæŠ€æœ¯èƒ½åŠ›è¯„ä¼°\r\ntags:\r\n- Blue TeamåŸºç¡€è®¾æ–½\r\n- ç»ˆç«¯åŸºç¡€è®¾æ–½\r\n- EDRèƒ½åŠ›è¯„ä¼°\r\n- èƒ½åŠ›è¯„ä¼°\r\n- MITRE\r\n---\r\n\r\n# 1. èƒŒæ™¯\r\nMITREæ¯å¹´ä¼šä¸¾åŠä¸€æ¬¡å®‰å…¨äº§å“èƒ½åŠ›è¯„ä¼°ï¼Œé€šè¿‡ATT&CKå’ŒçœŸå®çš„APTæ¡ˆä¾‹è¿›è¡Œæ”»å‡»æ¨¡æ‹Ÿï¼Œæœ€å¤§ç¨‹åº¦ç¯å¢ƒçœŸå®çš„æ”»å‡»åœºæ™¯ï¼Œæ•´ä½“è¿‡ç¨‹åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥ï¼š\r\n- **1. è®¾è®¡é˜¶æ®µ**\r\n  - é€‰æ‹©å¨èƒï¼ˆAPTäº‹ä»¶ã€æ¶æ„è½¯ä»¶ç­‰ï¼‰\r\n    - æ„å›¾ï¼š è€ƒè™‘å®‰å…¨ç¤¾åŒºæœ€å…³æ³¨çš„é—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œå‹’ç´¢è½¯ä»¶ä¸æ•°æ®çªƒå–ï¼‰\r\n    - å·®å¼‚åŒ–ï¼š å¹³è¡¡ä½¿ç”¨æ–°çš„å’Œä»¥å‰æµ‹è¯•è¿‡çš„æŠ€æœ¯\r\n    - å¤æ‚æ€§ï¼š è€ƒè™‘å¼€å‘èµ„æºä»¥åŠæˆ‘ä»¬æ˜¯åœ¨åŸºçº¿è¿˜æ˜¯æ¨åŠ¨é˜²å¾¡\r\n    - æƒ…æŠ¥ï¼š æˆ‘ä»¬è¯„ä¼°æƒ…æŠ¥çš„æ•°é‡å’Œè´¨é‡ä»¥å½»åº•äº†è§£å¯¹æ‰‹\r\n  - åˆ›å»ºä»¿çœŸè®¡åˆ’\r\n    - åˆ†è§£ï¼š å°†ç½‘ç»œå¨èƒæƒ…æŠ¥ (CTI) æå–åˆ°å•ç‹¬çš„ç¨‹åºä¸­\r\n    - é“¾æ¥ï¼š å°†ç¨‹åºé‡æ–°ç¼–è¯‘å¹¶ç»„ç»‡æˆä¸€ä¸ªæ›´å¤§çš„ä»¿çœŸåœºæ™¯\r\n    - ç»†åŒ–ï¼š æˆ‘ä»¬é€šè¿‡åˆä½œå’Œæœ‰é’ˆå¯¹æ€§çš„ç ”ç©¶å¡«è¡¥ç©ºç™½\r\n  - å¼€å‘ä»¿çœŸ\r\n    - å·¥å…·ï¼š é€‰æ‹©/æ„å»ºå¯ä»¥çœŸå®è¿˜åŸè¡Œä¸ºçš„æ”»å‡»æ€§å·¥å…·\r\n    - å®šåˆ¶ï¼š æ•æ‰é‡è¦çš„ç»†èŠ‚ï¼ˆä¾‹å¦‚ï¼ŒæŠ•é€’æœºåˆ¶ã€C2ç­‰ï¼‰\r\n    - å›é¡¾ï¼š ä¸ CTI è¿›è¡Œæ¯”è¾ƒå¹¶æ³¨æ„åå·®\r\n    - åˆ›å»ºï¼š å°†æ‰€æœ‰ä¿¡æ¯ç¼–è¯‘æˆä¸€ä¸ªç»“æ„åŒ–çš„ä»¿çœŸè®¡åˆ’\r\n- **2. æ‰§è¡Œé˜¶æ®µ**\r\n  - è®¿é—®ç¯å¢ƒ\r\n    - ç¯å¢ƒï¼š ä¸ºæ‰€æœ‰å‚å•†ä¾›æä¾›ç›¸åŒçš„æ‰§è¡Œç¯å¢ƒ\r\n    - å™ªéŸ³(ä»¿çœŸ)ï¼š é™¤äº†æ¨¡æ‹ŸæŠ€æœ¯ï¼ˆä¾‹å¦‚é”®ç›˜è®°å½•ï¼‰æ‰€éœ€çš„æ´»åŠ¨ä¹‹å¤–ï¼Œè¿˜æœ‰ç”¨æˆ·æ´»åŠ¨\r\n  - éƒ¨ç½²è§£å†³æ–¹æ¡ˆ\r\n    - è§£å†³æ–¹æ¡ˆï¼š å‚å•†ä½¿ç”¨å®é™…é…ç½®é…ç½®å…¶è§£å†³æ–¹æ¡ˆ\r\n    - é…ç½®ï¼š å‚å•†ç¡®ä¿é¢„é˜²ã€ä¿æŠ¤å’Œå“åº”ä»…ç”¨äºæ£€æµ‹è¯„ä¼°ï¼Œå¹¶è‡ªåŠ¨ç”¨äºä¿æŠ¤è¯„ä¼°\r\n    - * æ³¨æ„ï¼šæœªç»æ˜ç¡®æ‰¹å‡†ï¼Œç¦æ­¢åœ¨è¯„ä¼°å¼€å§‹åæ›´æ”¹é…ç½®\r\n  - æ‰§è¡Œè¯„ä¼°\r\n    - è¯„ä¼°è€…ï¼šå…¼ä»»æ”»å‡»è€…å’Œç›‘è€ƒè€…ï¼Œå¹¶æä¾›æ£€æµ‹æŒ‡å¯¼ä»¥ååŠ©å‚å•†\r\n    - é˜²å®ˆæ–¹ï¼š å‚å•†æ‹…ä»»ç´«é˜Ÿçš„è§’è‰²\r\n- **3. å‘å¸ƒ**\r\n  - å¤„ç†ç»“æœ\r\n    - ç‹¬ç‰¹æ€§ï¼š ç‹¬ç«‹è€ƒè™‘æ¯ä¸ªå‚å•†\r\n    - ä¸€è‡´æ€§ï¼š æ ¡å‡†æ‰€æœ‰ç»“æœä»¥ç¡®ä¿ä¸€è‡´æ€§\r\n  - æ¥æ”¶åé¦ˆ\r\n    - å®¡æ ¸ï¼š å‚å•†æœ‰ 10 å¤©çš„æ—¶é—´æä¾›åé¦ˆï¼Œå…¶ä¸­å¯ä»¥åŒ…æ‹¬è¦è€ƒè™‘çº³å…¥çš„å…¶ä»–æ•°æ®ï¼Œæˆ–å¯¹åˆæ­¥ç»“æœçš„ä¿®æ”¹\r\n    - åˆ†æï¼š ä¼šè€ƒè™‘æ‰€æœ‰åé¦ˆå¹¶åšå‡ºæœ€ç»ˆå†³å®š\r\n  - å‘å¸ƒç»“æœ\r\n    - è„±æ•ï¼š å‚å•†å¯¹æ•æ„Ÿæ€§é—®é¢˜ï¼ˆä¾‹å¦‚è§„åˆ™é€»è¾‘ï¼‰è¿›è¡Œæœ€ç»ˆå®¡æŸ¥\r\n    - å‘å¸ƒï¼š å…¬å¼€å‘å¸ƒç»“æœå’Œæ–¹æ³•\r\n\r\n# 2. 2021å¹´çš„è¯„ä¼°æ¨¡æ‹ŸCarbanak + FIN7\r\n- ä»‹ç»\r\n  - **Carbanak åœºæ™¯**ï¼š åˆæ³•ç”¨æˆ·æ‰§è¡Œé€šè¿‡é’ˆå¯¹é‡‘èæœºæ„çš„é±¼å‰å¼ç½‘ç»œé’“é±¼æ”»å‡»æä¾›çš„æ¶æ„è½½è·ã€‚åœ¨æ‹¿åˆ°æƒé™ä¹‹åï¼ŒCarbanak é€šè¿‡ç‰¹æƒå‡çº§ã€å‡­è¯è®¿é—®å’Œæ¨ªå‘ç§»åŠ¨æ¥æ‰©å±•å¯¹å…¶ä»–ä¸»æœºçš„è®¿é—®ï¼Œç›®çš„æ˜¯ç ´åè´§å¸å¤„ç†æœåŠ¡ã€è‡ªåŠ¨æŸœå‘˜æœºå’Œé‡‘èè´¦æˆ·ã€‚å½“ Carbanak æŸå®³æ½œåœ¨æœ‰ä»·å€¼çš„ç›®æ ‡æ—¶ï¼Œä»–ä»¬ä¼šå»ºç«‹æŒä¹…æ€§ï¼Œä»¥ä¾¿ä»–ä»¬å¯ä»¥äº†è§£é‡‘èç»„ç»‡çš„å†…éƒ¨ç¨‹åºå’ŒæŠ€æœ¯ã€‚ä½¿ç”¨è¿™äº›ä¿¡æ¯ï¼ŒCarbanak å°†èµ„é‡‘è½¬ç§»åˆ°ä»–ä»¬æ§åˆ¶çš„é“¶è¡Œè´¦æˆ·ï¼Œ\r\n  - **FIN7 åœºæ™¯**ï¼šæ­¤åœºæ™¯æ¨¡æ‹Ÿ FIN7 ä»¥é…’åº—ç»ç†ä¸ºç›®æ ‡ï¼Œä»¥è·å–ä¿¡ç”¨å¡ä¿¡æ¯ã€‚è¯¥åœºæ™¯å¼€å§‹äº FIN7 åœ¨ä¸çŸ¥æƒ…çš„ç”¨æˆ·æ‰§è¡Œæ¶æ„ .LNK æ–‡ä»¶åå®ç°å¯¹ç½‘ç»œçš„åˆå§‹è®¿é—®æƒé™ã€‚FIN7 ç„¶åè½¬å‘ç‰¹æƒ IT ç®¡ç†å‘˜å·¥ä½œç«™ã€‚ä»è¿™ä¸ªç³»ç»Ÿï¼ŒFIN7 é”®ç›˜è®°å½•è®¿é—®ä¼šè®¡å·¥ä½œç«™æ‰€éœ€çš„å‡­æ®ã€‚FIN7 ç„¶åè½¬å‘ä¼šè®¡å·¥ä½œç«™ï¼Œå»ºç«‹æŒä¹…æ€§ï¼Œå¹¶éƒ¨ç½²æ¶æ„è½¯ä»¶ä»è¿›ç¨‹å†…å­˜ä¸­æŠ“å–ä¿¡ç”¨å¡ä¿¡æ¯ã€‚\r\n- æ“ä½œæµç¨‹\r\n  - ![65iZsu](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/65iZsu.jpg)\r\n- æŠ€æœ¯èŒƒå›´\r\n  - å¯¹äº Carbanak å’Œ FIN7 è¯„ä¼°ï¼Œ11 ç§ ATT&CK ç­–ç•¥ä¸­çš„ 65 ç§ ATT&CK æŠ€æœ¯éƒ½åœ¨æ­¤è¯„ä¼°èŒƒå›´å†…ã€‚è¿™åŒ…æ‹¬æ¶µç›– Carbanak è¯„ä¼°çš„ Linux éƒ¨åˆ†çš„ 7 ç§ ATT&CK ç­–ç•¥ä¸­çš„ 12 ç§ ATT&CK æŠ€æœ¯ã€‚\r\n  - æ‚¨å¯ä»¥é€šè¿‡æŸ¥çœ‹æˆ‘ä»¬åœ¨[æ­¤å¤„](https://mitre-attack.github.io/attack-navigator/v2/enterprise/#layerURL=https://raw.githubusercontent.com/attackevals/website/master/downloadable_JSON/CarbanakFin7_Navigator_layer.json)æä¾›çš„å±‚æ–‡ä»¶ï¼Œåœ¨ ATT&CK å¯¼èˆªå™¨ä¸­æŸ¥çœ‹ Carbanak+FIN7 è¯„ä¼°çš„èŒƒå›´å†…æŠ€æœ¯ã€‚é¢„è§ˆå›¾å¦‚ä¸‹ï¼ä¸“é—¨å½’å› äº Carbanak çš„èŒƒå›´å†…çš„æŠ€æœ¯ä»¥è“è‰²çªå‡ºæ˜¾ç¤ºï¼Œä¸“é—¨å½’å› äº FIN7 çš„æŠ€æœ¯ä»¥çº¢è‰²çªå‡ºæ˜¾ç¤ºï¼Œè€Œ Carbanak å’Œ FIN7 å‡ä»¥é»„è‰²çªå‡ºæ˜¾ç¤ºã€‚\r\n  - ![IxwRMn](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/IxwRMn.jpg)\r\n- ç¯å¢ƒ\r\n  - è¯„ä¼°æ˜¯åœ¨ Microsoft Azure ä¸­è¿›è¡Œçš„ã€‚æ¯ä¸ªä¾›åº”å•†éƒ½æä¾›äº†ä¸¤ä¸ªç›¸åŒçš„ç¯å¢ƒï¼Œç”±å…«å°ä¸»æœºç»„æˆï¼Œæ¯å°ä¸»æœºéƒ½å®‰è£…äº†ä»–ä»¬çš„å®¢æˆ·ç«¯è½¯ä»¶ã€‚è¿™ä¸¤ç§ç¯å¢ƒåˆ†åˆ«ç”¨äºä»…æ£€æµ‹å’Œä¿æŠ¤æµ‹è¯•ã€‚\r\n  - ![9CiRAa](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/9CiRAa.jpg)\r\n\r\n# 3. ä¸¾ä¾‹ï¼šCrowdStrikeè¯„ä¼°ç»“æœ\r\n- å‘Šè­¦ç­–ç•¥\r\n  - æ”»å‡»ç›¸å…³çš„æŒ‡æ ‡éƒ½è¢«åˆ†é…äº†ä¸¥é‡ç­‰çº§ï¼ˆä¿¡æ¯ã€ä½ã€ä¸­ã€é«˜ã€ä¸¥é‡ï¼‰ï¼ŒåŒæ—¶è¿˜åŒ…å«äº†ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¦‚æ¦‚è¿°ã€å¯¹åº”çš„ATT&CKã€è¿›ç¨‹ã€ç”¨æˆ·ã€ä¸»æœºåŠå¯¹åº”çš„èµ„äº§ä¿¡æ¯ç­‰ã€‚æ­¤å¤–ï¼Œè¿˜ä½¿ç”¨CrowdScoreï¼ˆæ»¡åˆ† 10ï¼Œç»“åˆæ”»å‡»è¡Œä¸ºï¼Œè·¨è¿›ç¨‹ã€è·¨æœºå™¨ï¼‰æ¥è¡¡é‡å½“å‰æ”»å‡»è¡Œä¸ºåœ¨å®¢æˆ·ç¯å¢ƒçš„ä¸¥é‡ç¨‹åº¦ã€‚\r\n- å…¶ä»–ç­–ç•¥\r\n  - ![xoqt1H](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/xoqt1H.jpg)\r\n\r\n# 4. å‚è€ƒèµ„æ–™\r\n- [https://attackevals.mitre-engenuity.org/enterprise/participants/crowdstrike/results?adversary=carbanak_fin7&scenario=1#carbanak_fin7_test_11](https://attackevals.mitre-engenuity.org/enterprise/participants/crowdstrike/results?adversary=carbanak_fin7&scenario=1#carbanak_fin7_test_11)\r\n- [https://attackevals.mitre-engenuity.org/enterprise/carbanak_fin7](https://attackevals.mitre-engenuity.org/enterprise/carbanak_fin7)"},{"fields":{"slug":"/å®‰å…¨çŸ¥è¯†åº“/Blue TeamåŸºç¡€è®¾æ–½/ç»ˆç«¯åŸºç¡€è®¾æ–½/EDRèƒ½åŠ›è¯„ä¼°/Red Canary EDRä¹°å®¶æŒ‡å—/","title":"Red Canary EDRä¹°å®¶æŒ‡å—"},"frontmatter":{"draft":false},"rawBody":"---\r\ntitle: Red Canary EDRä¹°å®¶æŒ‡å—\r\ntags:\r\n- Blue TeamåŸºç¡€è®¾æ–½\r\n- ç»ˆç«¯åŸºç¡€è®¾æ–½\r\n- EDRèƒ½åŠ›è¯„ä¼°\r\n- Red Canary\r\n---\r\n\r\n# 1. èƒŒæ™¯\r\nRed Canary çš„æŠ€æœ¯å›¢é˜Ÿä¸€ç›´åœ¨å…³æ³¨ EDR å¸‚åœºï¼Œè¯„ä¼°æ–°æŠ€æœ¯ï¼Œå¹¶å·²æˆåŠŸæŒ‡å¯¼æ•°ä»¥åƒè®¡çš„ç»„ç»‡è¿›è¡Œ EDR çš„è¯„ä¼°å’Œå®æ–½ï¼Œæœ¬æŒ‡å—æ˜¯åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­è‡ªç„¶è€Œç„¶äº§å‡ºçš„ã€‚åœ¨è´­ä¹°EDRå‰æˆ‘ä»¬éœ€è¦äº†è§£ï¼š\r\n\r\n- å…¬å¸çš„ä¸šåŠ¡éœ€æ±‚ã€æŠ€æœ¯è¦æ±‚å’Œå†…éƒ¨èƒ½åŠ›\r\n- EDRäº§å“å¯¹å…¬å¸å®‰å…¨è¿è¥å¸¦æ¥çš„æ½œåœ¨å½±å“\r\n- ç”¨æ¥åŒºåˆ†EDRäº§å“çš„å…³é”®å› ç´ æ˜¯ä»€ä¹ˆ\r\n\r\næœ¬æŒ‡å—é‡ç‚¹ä»‹ç»äº†æ¯ä¸ªå®‰å…¨å›¢é˜Ÿåœ¨è´­ä¹° EDR äº§å“ä¹‹å‰éœ€è¦å›ç­”çš„ 14 ä¸ªé—®é¢˜ã€‚\r\n\r\n# 2. æœ€é‡è¦çš„é—®é¢˜\r\nä¸ºä»€ä¹ˆè¦è´­ä¹°EDRäº§å“?\r\n- è´­ä¹° EDR äº§å“çš„åŸå› æœ‰å¾ˆå¤šï¼Œäº†è§£æ‚¨çš„ç›®æ ‡æ˜¯å…³é”®ç¬¬ä¸€æ­¥ã€‚\r\n\r\n**ä¸šåŠ¡ä¾§é‡ç‚¹**\r\n- ä½¿ç”¨è¯¥è§£å†³æ–¹æ¡ˆéœ€è¦ä»€ä¹ˆæ°´å¹³çš„ä¸“ä¸šçŸ¥è¯†å’Œæ—¶é—´æŠ•å…¥ï¼Ÿ\r\n  - ![9P2IbH](https://cdn.jsdelivr.net/gh/MarsAuthority/sec_pic@master/uPic/2023-01/9P2IbH.jpg)\r\n  - å‚å•†æä¾›çš„è§£å†³æ–¹æ¡ˆï¼šMDRå’ŒMSSPã€‚\r\n- éƒ¨ç½²æ—¶å¯¹ä¸šåŠ¡æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ\r\n  - EDR è§£å†³æ–¹æ¡ˆåº”è¯¥å¯ä»¥ä½¿ç”¨ä»»ä½•æœ¬æœºæˆ–ç¬¬ä¸‰æ–¹éƒ¨ç½²å®ç”¨ç¨‹åºè½»æ¾éƒ¨ç½²åˆ°ç»ˆç«¯ã€‚ éœ€è¦é‡å¯çš„è§£å†³æ–¹æ¡ˆå¯èƒ½ä¼šäº§ç”Ÿé‡å¤§çš„ä¸šåŠ¡å½±å“ï¼Œå¹¶éœ€è¦æ›´å¤šçš„ç»„ç»‡åè°ƒã€‚\r\n- èƒ½å¦å–ä»£ç°æœ‰çš„ç»ˆç«¯å®‰å…¨æ–¹æ¡ˆï¼Ÿ\r\n  - ä»Šå¤©çš„è®¸å¤š EDR è§£å†³æ–¹æ¡ˆå¹¶ä¸ç›´æ¥å–ä»£å¸¸è§çš„å®‰å…¨æ–¹æ¡ˆï¼Œè€Œæ˜¯ä¸“æ³¨äºåŠ å¼ºå®‰å…¨æ€åŠ¿çš„ç‰¹å®šéƒ¨åˆ†ï¼›å¸¸è§çš„ç°æœ‰ç»ˆç«¯å®‰å…¨æ–¹æ¡ˆæœ‰ï¼š\r\n    - æ€æ¯’è½¯ä»¶ã€DLPã€FIMã€HIDSã€UBAç­‰ã€‚\r\n\r\n**æŠ€æœ¯èƒ½åŠ›**\r\n- æ”¯æŒå“ªäº›å¹³å°å’Œæ“ä½œç³»ç»Ÿï¼Ÿ\r\n  - ç†æƒ³æƒ…å†µä¸‹ï¼Œå•ä¸€è§£å†³æ–¹æ¡ˆå°†é€‚ç”¨äºæœåŠ¡å™¨ã€PCã€ç¬”è®°æœ¬ç”µè„‘å’Œå…¶ä»–ç»ˆç«¯ã€‚\r\n- æä¾›ä»€ä¹ˆçº§åˆ«çš„å¯è§æ€§ï¼Ÿ\r\n  - å¦‚æœ EDR ç¼ºä¹å¯¹æ•°æ®çš„æ”¶é›†ï¼Œåˆ™å®ƒçš„ä»·å€¼æœ‰é™ï¼› æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªç‰©ç†å®‰å…¨ç³»ç»Ÿï¼šå…‰å­¦å®‰å…¨æ‘„åƒå¤´è¿œä¸å¦‚èƒ½åŒæ—¶æ”¶é›† X å°„çº¿ã€çº¢å¤–çº¿å’ŒæŒ¯åŠ¨æ•°æ®çš„æ‘„åƒå¤´ã€‚\r\n  - å¸¸è§çš„æ•°æ®åŒ…å«ï¼šè¿›ç¨‹ä¿¡æ¯ã€ç½‘ç»œè¿æ¥ã€æ–‡ä»¶ä¿®æ”¹è®°å½•ã€æ³¨å†Œè¡¨è®°å½•ã€äºŒè¿›åˆ¶æ–‡ä»¶ã€å†…å®¹ã€ç”¨æˆ·ä¿¡æ¯ç­‰ã€‚\r\n- å¦‚ä½•ä¸é¢„é˜²æªæ–½ç›¸ç»“åˆï¼Ÿ\r\n  - EDR è§£å†³æ–¹æ¡ˆè¶Šæ¥è¶Šå¤šåœ°æˆä¸ºç»ˆç«¯ä¿æŠ¤å¹³å°çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯ç‹¬ç«‹çš„å·¥å…·ã€‚ é€‰æ‹©å…·æœ‰â€œå¤šåˆä¸€â€çš„è§£å†³æ–¹æ¡ˆéå¸¸é‡è¦ã€‚\r\n- å¦‚ä½•æ£€æµ‹é¢ä¸´çš„å¨èƒï¼Ÿ\r\n  - äº†è§£ EDR è§£å†³æ–¹æ¡ˆæ£€æµ‹åˆ°çš„å¨èƒç±»å‹ä»¥åŠä½¿ç”¨çš„æŠ€æœ¯å’ŒæŠ€å·§åº”è¯¥æ˜¯è¯„ä¼°çš„æ ¸å¿ƒã€‚ è®¸å¤šè§£å†³æ–¹æ¡ˆé‡‡ç”¨éå¸¸æœ‰é™çš„æ£€æµ‹æ–¹æ³•ï¼Œå¹¶ä¸”æ— æ³•æä¾›æ›´å¹¿æ³›çš„å¨èƒè¦†ç›–èŒƒå›´ã€‚\r\n  - åŒ…å«ï¼šè¦†ç›–èŒƒå›´ã€è¯¯æŠ¥ç‡ã€æ¼æŠ¥ç‡ã€å“åº”æ—¶é—´ã€æœ‰æ•ˆæ€§ç­‰ã€‚\r\n- æä¾›ä»€ä¹ˆæ ·çš„å“åº”å¤„ç½®èƒ½åŠ›ï¼Ÿ\r\n  - éœ€è¦èƒ½å¤Ÿç«‹å³å¯¹å¨èƒåšå‡ºååº”å¹¶åœ¨å®ƒå¯¹æ‚¨çš„ç»„ç»‡é€ æˆæ›´å¤§æŸå®³ä¹‹å‰é˜»æ­¢å®ƒã€‚\r\n- æœ‰å“ªäº›ç±»å‹çš„æŠ¥å‘Šå¯ç”¨ï¼Ÿ\r\n  - EDR è§£å†³æ–¹æ¡ˆæä¾›çš„æŠ¥å‘Šå¯¹äºè·å¾—çš„ä»·å€¼è‡³å…³é‡è¦ï¼›è¿™é€‚ç”¨äºéšæ¯ä¸ªå¨èƒæ£€æµ‹æä¾›çš„æŠ¥å‘Šä»¥åŠæœ‰å…³ç»ˆç«¯å’Œä¼ä¸šçš„æ‘˜è¦æŠ¥å‘Šã€‚\r\n\r\n**å®‰å…¨èƒ½åŠ›æ•´åˆ**\r\n- æ˜¯å¦ä¸å…¶ä»–å®‰å…¨å·¥å…·é›†æˆ/è”åŠ¨ï¼Ÿ\r\n  - å°† EDR æ·±åº¦é›†æˆåˆ°ç°æœ‰çš„å®‰å…¨èƒ½åŠ›å’Œ IT å·¥å…·ï¼Œèƒ½å¤Ÿæœ€æœ‰æ•ˆåœ°ä»è§£å†³æ–¹æ¡ˆä¸­è·å¾—æœ€å¤§ä»·å€¼ã€‚\r\n- å¯¹ç»ˆç«¯ä¼šé€ æˆä»€ä¹ˆå½±å“?\r\n  - å‡ ä¹æ‰€æœ‰ EDR è§£å†³æ–¹æ¡ˆéƒ½é€šè¿‡Agentæ–¹å¼éƒ¨ç½²åˆ°ç»ˆç«¯ï¼Œè¿™æ„å‘³ç€å¦‚æœå®ƒæ²¡æœ‰ç»è¿‡è‰¯å¥½çš„è®¾è®¡å’Œæµ‹è¯•ï¼Œå¯èƒ½ä¼šäº§ç”Ÿä¸¥é‡çš„æ€§èƒ½å½±å“å¹¶å¯¼è‡´ä¸ç¨³å®šã€‚ åº”è¯¥æä¾›åœ¨ç±»ä¼¼æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶ä¸Šæµ‹è¯•çš„æ€§èƒ½æ•°æ®ï¼Œä»¥åŠåœ¨è¿è¡Œç±»ä¼¼åº”ç”¨ç¨‹åºæ—¶çš„æ€§èƒ½æ•°æ®ã€‚\r\n- ä½¿ç”¨å“ªäº›å®‰å…¨æ§åˆ¶æ¥ä¿æŠ¤è‡ªå·±å…å—æ”»å‡»è€…çš„æ”»å‡»ï¼Ÿ\r\n  - å¦‚æœè®¾è®¡ä¸å½“ï¼ŒEDR è§£å†³æ–¹æ¡ˆå¯èƒ½ä¼šå¸¦æ¥å·¨å¤§çš„å®‰å…¨é£é™©ï¼›ç¡®ä¿EDRè‡ªèº«éƒ½æœ‰ä¸¥æ ¼çš„å®‰å…¨ç­–ç•¥ï¼Œå¹¶ç»è¿‡ç¬¬ä¸‰æ–¹æµ‹è¯•ã€‚\r\n- å‚å•†æä¾›å“ªäº›æ”¯æŒï¼Ÿ\r\n  - å‚å•†æä¾›çš„æŠ€æœ¯æ”¯æŒå°†æå¤§åœ°å½±å“æ½œåœ¨æˆæœ¬ä»¥åŠéƒ¨ç½²ã€æ’é™¤æ•…éšœå’Œä¼˜åŒ– EDR è§£å†³æ–¹æ¡ˆçš„èƒ½åŠ›ã€‚\r\n\r\n# 3. å‚è€ƒèµ„æ–™\r\n- [https://docs.google.com/viewerng/viewer?url=https://resource.redcanary.com/rs/003-YRU-314/images/EDR-Buyers-Guide-2020.pdf](https://docs.google.com/viewerng/viewer?url=https://resource.redcanary.com/rs/003-YRU-314/images/EDR-Buyers-Guide-2020.pdf)"}]}}}